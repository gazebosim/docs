<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="keywords" content="Gazebo Rendering">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gazebo Rendering: Environment Map</title>
    <script type="text/javascript" src="https://gazebosim.org/assets/doxygen/dynsections.js"></script>
    <script type="text/javascript" src="jquery.js"></script>
    <link rel="icon" type="image/x-icon" href="https://gazebosim.org/assets/icon/favicon.ico">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.deep_orange-blue.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script>
    <link href="https://gazebosim.org/assets/doxygen/doxygen.css" rel="stylesheet" type="text/css">
  </head>
    <script type="text/javascript">
      /* Replace all the "permalink" &#9670;&nbsp; icons with a unicode link
        symbol.*/
      $(document).ready(function() {
        var elems = document.getElementsByClassName("permalink");
        for (var i = 0; i < elems.length; ++i) {
          elems[i].firstChild.innerHTML="&#x1f517;";
          elems[i].firstChild.style.fontSize="18px";
        }
      });
    </script>
  </head>
<body>
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer">
    <div class="mdl-layout__drawer mdl-color--grey-100 mdl-color-text--blue-grey-50">
      <header class="mdl-color--grey-100">
        <a href="index.html"><img width="60px" src="https://gazebosim.org/assets/doxygen/gazebo_logo.svg"/></a>
        <h1 class="project_title">Gazebo Rendering</h1>
        <h2>API Reference</h2>
        <div class="version">
        10.0.0
        </div>
      </header>
      <!-- NOTE: If you add a link to a doxygen generated page, then make
                 sure to update the required_html_fils list in
                 GzCreateDocs.cmake -->
      <nav class="gz-navigation mdl-navigation">
        <a class="mdl-navigation__link" href="tutorials.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Tutorials</a>
        <a id="class_menu" class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">library_books</i>Classes</a>
        <a id="namespaces_menu"class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">toc</i>Namespaces</a>
        <a class="mdl-navigation__link" href="files.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Files</a>
        <a class="mdl-navigation__link" target="_blank"
           href="http://gazebosim.org">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">launch</i>Gazebo Website</a>
      </nav>
      <!-- classes sub menu -->
      <ul for="class_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link" href="classes.html">Index</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="annotated.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="hierarchy.html">Hierarchy</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions.html">Members: All</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_func.html">Members: Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_vars.html">Members: Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_type.html">Members: Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_enum.html">Members: Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_eval.html">Members: Enumerator</a>
        </li>
      </ul>
      <!-- namespaces sub menu -->
      <ul for="namespaces_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespaces.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers.html">Members</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_func.html">Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_type.html">Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_vars.html">Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_enum.html">Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_eval.html">Enumerator</a>
        </li>
      </ul>
    </div>
    <main class="mdl-layout__content mdl-color--white">
    <div id="top">
<!-- Generated by Doxygen 1.9.8 -->
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Environment Map</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial shows how to add an environment map to a mesh.</p>
<p>An environment map, also known as a reflection map, is an efficient way to create reflective surfaces using a precomputed texture. The environment map texture used by gz rendering needs to be the form of a cube map.</p>
<h2><a class="anchor" id="install-prerequisites-11"></a>
Install prerequisites</h2>
<p>In order to compile the example in this tutorial, make sure to install the dependencies listed in the <a class="el" href="installation.html">Installation</a> tutorial.</p>
<h2><a class="anchor" id="example-mesh-with-environment-map"></a>
Example mesh with Environment map</h2>
<p>An example of a mesh with an environment map can be found in the <code>ogre2_demo</code>, which uses the ogre2 render engine.</p>
<p>To see the example mesh, build and run the demo:</p>
<div class="fragment"><div class="line">cd gz-rendering/examples/ogre2_demo</div>
<div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake ..</div>
<div class="line">make</div>
</div><!-- fragment --><p>Now run it:</p>
<div class="fragment"><div class="line">./ogre2_demo</div>
</div><!-- fragment --><div class="image">
<img src="ogre2_sky_envmap.png" alt=""/>
</div>
<p>There are two meshes in the scene with environment maps. One is the pump and the other is the gray box on the left. The effect is more evident on the gray box as it uses a mirror-like material with low roughness and high metalness values. If you look at the box mesh from different angles, you will notice that there are reflections of the sky. This mesh is using the same cube map as the one that is used to create the skybox.</p>
<h2><a class="anchor" id="code-10"></a>
Code</h2>
<p>The code creates a mirror-like material and sets the environment map by giving it the path to the sky cube map texture.</p>
<div class="fragment"><div class="line">  <span class="comment">// create mirror material</span></div>
<div class="line">  MaterialPtr mirrorMat = _scene-&gt;CreateMaterial();</div>
<div class="line">  mirrorMat-&gt;SetDiffuse(1.0, 1.0, 1.0);</div>
<div class="line">  mirrorMat-&gt;SetRoughness(0.1);</div>
<div class="line">  mirrorMat-&gt;SetMetalness(0.9);</div>
<div class="line">  <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> skyEnvironmentMap =</div>
<div class="line">      common::joinPaths(RESOURCE_PATH, <span class="stringliteral">&quot;skybox_lowres.dds&quot;</span>);</div>
<div class="line">  mirrorMat-&gt;SetEnvironmentMap(skyEnvironmentMap);</div>
</div><!-- fragment --><h2><a class="anchor" id="creating-a-cube-map"></a>
Creating a cube map</h2>
<p>The cube map accepted by the ogre2 render engine needs to be in a specific format. You can use the <code>gimp-dds</code> plugin to create the texture.</p>
<p>Let's take a look at the sky cube map in gimp. Open <code>gimp</code> and import the <a href="https://github.com/gazebosim/gz-rendering/blob/main/examples/ogre2_demo/media/skybox_lowres.dds?raw=true">sky_lowres.dds</a> file. Look at the <code>Layers</code> windows (<code>Windows</code> &gt; <code>Dockable Dialogs</code> &gt; <code>Layers</code>) to see that each face of the cube map is in its own individual layer.</p>
<div class="image">
<img src="skybox_gimp_layers.png" alt=""/>
</div>
<p>To create a new cube map, you will need to have a similar setup to the one shown above. One way to do this is to modify an existing cube map in gz rendering and replace the image in each layer with your new cube map images (there should be 6 of them - one for each face). You can resize the canvas to match the texture size of you new cube map. Pay attention to the orientation of the image in each layer as it could be different from the orientation of other readily available cube maps online since gz rendering uses Z up instead of Y up.</p>
<p>Once you are done, export the new cube map by going to <code>File</code> &gt; <code>Export As</code>, give it a new name, and click <code>Export</code>. In the <code>Save as DDS</code> dialog, make sure to select <code>Save</code>: <code>As cube map</code> and <code>Mipmaps</code>: <code>No mipmaps</code>. Your newly exported cube map should be ready to use in gz rendering. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
      </div>
    </main>
  </div>
</body>
