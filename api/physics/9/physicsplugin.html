<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="keywords" content="Gazebo Physics">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gazebo Physics: Understanding the Physics Plugin</title>
    <script type="text/javascript" src="https://gazebosim.org/assets/doxygen/dynsections.js"></script>
    <script type="text/javascript" src="jquery.js"></script>
    <link rel="icon" type="image/x-icon" href="https://gazebosim.org/assets/icon/favicon.ico">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.deep_orange-blue.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script>
    <link href="https://gazebosim.org/assets/doxygen/doxygen.css" rel="stylesheet" type="text/css">
  </head>
    <script type="text/javascript">
      /* Replace all the "permalink" &#9670;&nbsp; icons with a unicode link
        symbol.*/
      $(document).ready(function() {
        var elems = document.getElementsByClassName("permalink");
        for (var i = 0; i < elems.length; ++i) {
          elems[i].firstChild.innerHTML="&#x1f517;";
          elems[i].firstChild.style.fontSize="18px";
        }
      });
    </script>
  </head>
<body>
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer">
    <div class="mdl-layout__drawer mdl-color--grey-100 mdl-color-text--blue-grey-50">
      <header class="mdl-color--grey-100">
        <a href="index.html"><img width="60px" src="https://gazebosim.org/assets/doxygen/gazebo_logo.svg"/></a>
        <h1 class="project_title">Gazebo Physics</h1>
        <h2>API Reference</h2>
        <div class="version">
        9.0.0
        </div>
      </header>
      <!-- NOTE: If you add a link to a doxygen generated page, then make
                 sure to update the required_html_fils list in
                 GzCreateDocs.cmake -->
      <nav class="gz-navigation mdl-navigation">
        <a class="mdl-navigation__link" href="tutorials.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Tutorials</a>
        <a id="class_menu" class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">library_books</i>Classes</a>
        <a id="namespaces_menu"class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">toc</i>Namespaces</a>
        <a class="mdl-navigation__link" href="files.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Files</a>
        <a class="mdl-navigation__link" target="_blank"
           href="http://gazebosim.org">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">launch</i>Gazebo Website</a>
      </nav>
      <!-- classes sub menu -->
      <ul for="class_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link" href="classes.html">Index</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="annotated.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="hierarchy.html">Hierarchy</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions.html">Members: All</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_func.html">Members: Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_vars.html">Members: Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_type.html">Members: Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_enum.html">Members: Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_eval.html">Members: Enumerator</a>
        </li>
      </ul>
      <!-- namespaces sub menu -->
      <ul for="namespaces_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespaces.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers.html">Members</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_func.html">Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_type.html">Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_vars.html">Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_enum.html">Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_eval.html">Enumerator</a>
        </li>
      </ul>
    </div>
    <main class="mdl-layout__content mdl-color--white">
    <div id="top">
<!-- Generated by Doxygen 1.9.8 -->
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Understanding the Physics Plugin</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The <a class="el" href="namespacegz_1_1physics.html">Gazebo Physics</a> library integrates physics engines into the Gazebo Simulation eco-system. Each physics engine is wrapped into a Gazebo Physics Plugin that can be loaded in a Gazebo simulation. The Physics Plugin interface loads physics engines with the requested features at runtime. It is also possible to integrate your own selected physics engine by writing a compatible plugin interface.</p>
<p>To get a more in-depth understanding of how the physics plugin works in Gazebo, we will start with some high level concepts and definitions.</p>
<h2><a class="anchor" id="high-level-concept"></a>
High Level Concept</h2>
<p>Conceptually, the physics plugin can be viewed from two sides of its interface: user vs. implementation.</p>
<p>Each physics engine provides access to different features implemented by the Gazebo Physics engine. The interface is made possible through the <a class="elRef" href="https://gazebosim.org/api/plugin/4/namespacegz_1_1plugin.html">Gazebo Plugin</a> library, which instantiates <a class="el" href="classgz_1_1physics_1_1Feature.html">Features</a> in <a class="el" href="structgz_1_1physics_1_1FeatureList.html">FeatureLists</a> and supplies pointers to the selected engine. This "user side interface" makes the Gazebo Physics library "callable" from other Gazebo libraries.</p>
<p>The implementation side interface handles specific implementations of each <code>Feature</code>. Depending on what physics engine we are using in the plugin (DART, TPE etc.), the interface might be different. This interface is more internal facing, i.e. used mostly inside the Gazebo Physics library.</p>
<p>The implementation of the physics plugin revolves around four key elements.</p>
<ol type="1">
<li><p class="startli"><a class="el" href="classgz_1_1physics_1_1Entity.html">Entity</a></p>
<p class="startli">This is the base class of all "proxy objects". The "proxy objects" are essentially interfaces into the actual objects which exist inside of the various physics engine implementations. The proxy objects contain the minimal amount of data (e.g. a unique identifier, a reference-counter for the implementation object, and a reference to the implementation interface that it needs) necessary to interface with the object inside of the implementation that it refers to.</p>
</li>
<li><p class="startli"><a class="el" href="structgz_1_1physics_1_1FeaturePolicy.html">FeaturePolicy</a></p>
<p class="startli">FeaturePolicy is a "policy class" used to provide metadata to features about what kind of simulation engine they are going to be used in. Many physics simulations software libraries model 3-dimensional systems, though some (like Box2d) only consider 2-dimensional systems. A FeaturePolicy is used to customize Gazebo Physics' APIs by the number of dimensions (2 or 3) and also the floating point scalar type (float or double). (All of the currently supported physics engines use FeaturePolicy3d i.e. 3 dimensions and double.)</p>
</li>
<li><p class="startli"><a class="el" href="classgz_1_1physics_1_1Feature.html">Feature</a></p>
<p class="startli">This class defines the concept of a <code>Feature</code>, examples like <code>GetWorldFromEngine</code>, <a class="el" href="classgz_1_1physics_1_1GetEngineInfo.html">GetEngineInfo</a> etc. There is a pre-defined list of features in Gazebo Physics. They are implemented by using external physics engines' APIs to fulfill simulation needs requested by Gazebo.</p>
</li>
<li><p class="startli"><a class="el" href="structgz_1_1physics_1_1FeatureList.html">FeatureList</a></p>
<p class="startli">This is the class that aggregates a list of features. FeatureLists can be constructed in hierarchies, e.g. a <code>FeatureList</code> can be passed into another <code>FeatureList</code>, and the set of all features in the new list will be the sum.</p>
</li>
</ol>
<h2><a class="anchor" id="featurelist-organization"></a>
FeatureList Organization</h2>
<p>For example, here are the <code>FeatureLists</code> used in the implementation of the <code>Dartsim</code> physics engine. Plugin implementations for other engines may choose to organize features into <code>FeatureLists</code> differently.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Definition    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Base   </td><td class="markdownTableBodyNone">contains data structures and functions that define and use "proxy objects"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">CustomFeatures   </td><td class="markdownTableBodyNone">retrieves <code>World</code> entity from physics engine    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">EntityManagementFeatures   </td><td class="markdownTableBodyNone">provides features to get, remove and construct entities    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">FreeGroupFeatures   </td><td class="markdownTableBodyNone">finds free group entities and sets world pose, linear and angular velocities    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">JointFeatures   </td><td class="markdownTableBodyNone">defines types of joints used and sets joint properties    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">KinematicsFeatures   </td><td class="markdownTableBodyNone">computes frame relative to world    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">LinkFeatures   </td><td class="markdownTableBodyNone">applies external force and torque to link    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SDFFeatures   </td><td class="markdownTableBodyNone">constructs entities from SDF file    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ShapeFeatures   </td><td class="markdownTableBodyNone">retrieves <code>Shape</code> related properties like <code>BoundingBox</code>, <code>ShapeSize</code> etc.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SimulationFeatures   </td><td class="markdownTableBodyNone">updates <code>World</code> and everything within by defined stepsize    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">WorldFeatures   </td><td class="markdownTableBodyNone">sets options like solver and collision detector   </td></tr>
</table>
<h2><a class="anchor" id="available-physics-plugins"></a>
Available Physics Plugins</h2>
<p>Dart (<a href="https://dartsim.github.io/">Dynamic Animation and Robotics Toolkit</a>) is an open source library that provides data structures and algorithms for kinematic and dynamic applications in robotics and computer animation. It is the default physics engine used in Gazebo Simulation. The source code for Dartsim plugin can be found in <a href="https://github.com/gazebosim/gz-physics/tree/gz-physics9">Gazebo Physics repository</a> under <code>dartsim</code> directory.</p>
<p>TPE (<a href="https://github.com/gazebosim/gz-physics/tree/gz-physics9/tpe">Trivial Physics Engine</a>) is an open source library created by Open Robotics that enables fast, inexpensive kinematics simulation for entities at large scale. It supports higher-order fleet dynamics without real physics (eg. gravity, force, constraint etc.) and multi-machine synchronization. The source code for TPE plugin can be found in <a href="https://github.com/gazebosim/gz-physics/tree/gz-physics9">Gazebo Physics repository</a> under the <code>tpe/plugin</code> directory.</p>
<p>Bullet (<a href="https://github.com/bulletphysics/bullet3">Bullet3 Physics Engine</a>) is an open source library that supports real-time collision detection and multi-physics simulation for robotics and other application domains. Since Bullet supports two different APIs - a rigid-body API and a multibody API - with different physics implementations, there are two available plugin implementations:</p><ul>
<li>The <code>bullet</code> plugin implements the rigid-body API, and the source code can be found in <a href="https://github.com/gazebosim/gz-physics/tree/gz-physics9">Gazebo Physics repository</a> under the <code>bullet</code> directory.</li>
<li>The <code>bullet-featherstone</code> plugin implements the multibody API (based on Featherstone's algorithms), and the source code can be found in <a href="https://github.com/gazebosim/gz-physics/tree/gz-physics9">Gazebo Physics repository</a> under the <code>bullet-featherstone</code> directory.</li>
</ul>
<h3><a class="anchor" id="entity-comparison"></a>
Entity Comparison</h3>
<p>The following is a table of <code>Entity</code> names used in the Gazebo Physics plugin interface, mapped to corresponding types in each supported physics engine. Entities are arranged in top-down hierarchical order.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Physics Plugin   </th><th class="markdownTableHeadCenter">Dart   </th><th class="markdownTableHeadCenter">TPE   </th><th class="markdownTableHeadCenter">Bullet   </th><th class="markdownTableHeadCenter">Bullet Featherstone    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Engine   </td><td class="markdownTableBodyCenter">Engine   </td><td class="markdownTableBodyCenter">Engine   </td><td class="markdownTableBodyCenter">Engine   </td><td class="markdownTableBodyCenter">Engine    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">World   </td><td class="markdownTableBodyCenter">World   </td><td class="markdownTableBodyCenter">World   </td><td class="markdownTableBodyCenter">btDiscreteDynamicsWorld   </td><td class="markdownTableBodyCenter">btMultiBodyDynamicsWorld    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Frame   </td><td class="markdownTableBodyCenter">Frame   </td><td class="markdownTableBodyCenter">N/A   </td><td class="markdownTableBodyCenter">N/A<sup>1</sup>   </td><td class="markdownTableBodyCenter">N/A<sup>1</sup>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Model   </td><td class="markdownTableBodyCenter">Skeleton   </td><td class="markdownTableBodyCenter">Model   </td><td class="markdownTableBodyCenter">N/A<sup>2</sup>   </td><td class="markdownTableBodyCenter">btMultiBody    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Joint   </td><td class="markdownTableBodyCenter">Joint   </td><td class="markdownTableBodyCenter">N/A   </td><td class="markdownTableBodyCenter">btTypedConstraint   </td><td class="markdownTableBodyCenter">btMultiBodyJoint<sup>3</sup>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Link   </td><td class="markdownTableBodyCenter">BodyNode   </td><td class="markdownTableBodyCenter">Link   </td><td class="markdownTableBodyCenter">btRigidBody   </td><td class="markdownTableBodyCenter">btMultiBodyLink    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Shape   </td><td class="markdownTableBodyCenter">Shape   </td><td class="markdownTableBodyCenter">Collision   </td><td class="markdownTableBodyCenter">btCollisionShape   </td><td class="markdownTableBodyCenter">btCollisionShape    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Box/Sphere/Cylinder etc.   </td><td class="markdownTableBodyCenter">Box/Sphere/Cylinder etc.   </td><td class="markdownTableBodyCenter">Box/Sphere/Cylinder etc.   </td><td class="markdownTableBodyCenter">Box/Sphere/Cylinder etc.   </td><td class="markdownTableBodyCenter">Box/Sphere/Cylinder etc.   </td></tr>
</table>
<p><sup>1</sup> Frames are implicitly attached to joints, links, collisions or models in the Bullet physics engine.</p>
<p><sup>2</sup> The Bullet rigid-body API does not have a concept of a Model, but the plugin maintains a collection of Links and Joints in the engine associated with a Model.</p>
<p><sup>3</sup> There are multiple types in the Bullet Featherstone API to interact with joints, such as btMultiBodyJointLimitConstraint, btMultiBodyJointMotor and btMultiBodyJointFeedback.</p>
<h3><a class="anchor" id="feature-comparison"></a>
Feature Comparison</h3>
<p>For a list of all available <code>Features</code> in the Gazebo Physics library, check the classes inherited from <code>Feature</code> in the <a href="https://gazebosim.org/api/physics/8/hierarchy.html">Gazebo Physics API</a>. To check if a physics plugin implements a particular <code>Feature</code>, check the <code>FeatureLists</code> supported by that plugin as specified in the plugin.cc file, for example, <a href="https://github.com/gazebosim/gz-physics/blob/gz-physics9/dartsim/src/plugin.cc">dartsim/src/plugin.cc</a>.</p>
<p>Next, check out the tutorial on <a class="el" href="pluginloading.html">Loading physics plugins</a> on how to load a plugin and access a specific <code>Feature</code> interface of the plugin programmatically. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
      </div>
    </main>
  </div>
</body>
