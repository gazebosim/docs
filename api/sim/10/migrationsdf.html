<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="keywords" content="Gazebo Sim">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gazebo Sim: Migration from Gazebo classic: SDF</title>
    <script type="text/javascript" src="https://gazebosim.org/assets/doxygen/dynsections.js"></script>
    <script type="text/javascript" src="jquery.js"></script>
    <link rel="icon" type="image/x-icon" href="https://gazebosim.org/assets/icon/favicon.ico">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.deep_orange-blue.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script>
    <link href="https://gazebosim.org/assets/doxygen/doxygen.css" rel="stylesheet" type="text/css">
  </head>
    <script type="text/javascript">
      /* Replace all the "permalink" &#9670;&nbsp; icons with a unicode link
        symbol.*/
      $(document).ready(function() {
        var elems = document.getElementsByClassName("permalink");
        for (var i = 0; i < elems.length; ++i) {
          elems[i].firstChild.innerHTML="&#x1f517;";
          elems[i].firstChild.style.fontSize="18px";
        }
      });
    </script>
  </head>
<body>
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer">
    <div class="mdl-layout__drawer mdl-color--grey-100 mdl-color-text--blue-grey-50">
      <header class="mdl-color--grey-100">
        <a href="index.html"><img width="60px" src="https://gazebosim.org/assets/doxygen/gazebo_logo.svg"/></a>
        <h1 class="project_title">Gazebo Sim</h1>
        <h2>API Reference</h2>
        <div class="version">
        10.0.0
        </div>
      </header>
      <!-- NOTE: If you add a link to a doxygen generated page, then make
                 sure to update the required_html_fils list in
                 GzCreateDocs.cmake -->
      <nav class="gz-navigation mdl-navigation">
        <a class="mdl-navigation__link" href="tutorials.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Tutorials</a>
        <a id="class_menu" class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">library_books</i>Classes</a>
        <a id="namespaces_menu"class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">toc</i>Namespaces</a>
        <a class="mdl-navigation__link" href="files.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Files</a>
        <a class="mdl-navigation__link" target="_blank"
           href="http://gazebosim.org">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">launch</i>Gazebo Website</a>
      </nav>
      <!-- classes sub menu -->
      <ul for="class_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link" href="classes.html">Index</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="annotated.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="hierarchy.html">Hierarchy</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions.html">Members: All</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_func.html">Members: Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_vars.html">Members: Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_type.html">Members: Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_enum.html">Members: Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_eval.html">Members: Enumerator</a>
        </li>
      </ul>
      <!-- namespaces sub menu -->
      <ul for="namespaces_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespaces.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers.html">Members</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_func.html">Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_type.html">Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_vars.html">Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_enum.html">Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_eval.html">Enumerator</a>
        </li>
      </ul>
    </div>
    <main class="mdl-layout__content mdl-color--white">
    <div id="top">
<!-- Generated by Doxygen 1.9.8 -->
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Migration from Gazebo classic: SDF</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Both Gazebo classic and Gazebo support <a href="http://sdformat.org/">SDF</a> files to describe the simulation to be loaded. An SDF file defines the world environment, the robot's characteristics and what plugins to load.</p>
<p>Despite using the same description format, users will note that the same SDF file may behave differently for each simulator. This tutorial will explain how to write SDF files in a way that they're as reusable by both simulators as possible. It will also explain when you'll need to use separate files for each simulator.</p>
<p>The minimum required versions to use this guide are:</p>
<ul>
<li>Gazebo 11.2.0</li>
<li>Igniton Citadel</li>
</ul>
<h2><a class="anchor" id="uris"></a>
URIs</h2>
<p>SDF files use URIs to refer to resources from other files, such as meshes and nested models. These are some of the SDF tags that take URIs:</p>
<ul>
<li><code>&lt;include&gt;&lt;uri&gt;</code></li>
<li><code>&lt;mesh&gt;&lt;uri&gt;</code></li>
<li><code>&lt;material&gt;&lt;pbr&gt;&lt;...&gt;&lt;*_map&gt;</code> (only on Gazebo)</li>
<li><code>&lt;actor&gt;&lt;skin&gt;&lt;filename&gt;</code></li>
<li><code>&lt;actor&gt;&lt;animation&gt;&lt;filename&gt;</code></li>
</ul>
<p>Here are the recommended ways to use URIs from most recommended to least:</p>
<h3><a class="anchor" id="gazebo-fuel-url"></a>
Gazebo Fuel URL</h3>
<p>It's possible to use URLs of resources on <a href="https://app.gazebosim.org">Gazebo Fuel</a> within any of the tags above and both simulators will be able to load it.</p>
<p>For example, this world can be loaded into both simulators:</p>
<div class="fragment"><div class="line">&lt;sdf version=&quot;1.7&quot;&gt;</div>
<div class="line">  &lt;world name=&quot;demo&quot;&gt;</div>
<div class="line">    &lt;!-- Included light --&gt;</div>
<div class="line">    &lt;include&gt;</div>
<div class="line">      &lt;uri&gt;https://fuel.gazebosim.org/1.0/OpenRobotics/models/Sun&lt;/uri&gt;</div>
<div class="line">    &lt;/include&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;!-- Included model --&gt;</div>
<div class="line">    &lt;include&gt;</div>
<div class="line">      &lt;uri&gt;https://fuel.gazebosim.org/1.0/OpenRobotics/models/Ground Plane&lt;/uri&gt;</div>
<div class="line">    &lt;/include&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;model name=&quot;Radio&quot;&gt;</div>
<div class="line">      &lt;pose&gt;3 -1.5 0 0 0 0&lt;/pose&gt;</div>
<div class="line">      &lt;static&gt;true&lt;/static&gt;</div>
<div class="line">      &lt;link name=&quot;link&quot;&gt;</div>
<div class="line">        &lt;collision name=&quot;collision&quot;&gt;</div>
<div class="line">          &lt;geometry&gt;</div>
<div class="line">            &lt;!-- Collision mesh --&gt;</div>
<div class="line">            &lt;mesh&gt;</div>
<div class="line">              &lt;uri&gt;https://fuel.gazebosim.org/1.0/OpenRobotics/models/Radio/4/files/meshes/Radio.dae&lt;/uri&gt;</div>
<div class="line">            &lt;/mesh&gt;</div>
<div class="line">          &lt;/geometry&gt;</div>
<div class="line">        &lt;/collision&gt;</div>
<div class="line">        &lt;visual name=&quot;visual&quot;&gt;</div>
<div class="line">          &lt;geometry&gt;</div>
<div class="line">            &lt;!-- Visual mesh --&gt;</div>
<div class="line">            &lt;mesh&gt;</div>
<div class="line">              &lt;uri&gt;https://fuel.gazebosim.org/1.0/OpenRobotics/models/Radio/4/files/meshes/Radio.dae&lt;/uri&gt;</div>
<div class="line">            &lt;/mesh&gt;</div>
<div class="line">          &lt;/geometry&gt;</div>
<div class="line">        &lt;/visual&gt;</div>
<div class="line">      &lt;/link&gt;</div>
<div class="line">    &lt;/model&gt;</div>
<div class="line"> </div>
<div class="line">    &lt;actor name=&quot;actor_talking&quot;&gt;</div>
<div class="line">      &lt;skin&gt;</div>
<div class="line">        &lt;filename&gt;https://fuel.gazebosim.org/1.0/OpenRobotics/models/actor - relative paths/tip/files/meshes/talk_b.dae&lt;/filename&gt;</div>
<div class="line">        &lt;scale&gt;1.0&lt;/scale&gt;</div>
<div class="line">      &lt;/skin&gt;</div>
<div class="line">      &lt;animation name=&quot;talk_b&quot;&gt;</div>
<div class="line">        &lt;filename&gt;https://fuel.gazebosim.org/1.0/OpenRobotics/models/actor - relative paths/tip/files/meshes/talk_b.dae&lt;/filename&gt;</div>
<div class="line">        &lt;scale&gt;1.0&lt;/scale&gt;</div>
<div class="line">      &lt;/animation&gt;</div>
<div class="line">      &lt;script&gt;</div>
<div class="line">        &lt;loop&gt;true&lt;/loop&gt;</div>
<div class="line">        &lt;auto_start&gt;true&lt;/auto_start&gt;</div>
<div class="line">        &lt;trajectory id=&quot;0&quot; type=&quot;talk_b&quot;&gt;</div>
<div class="line">          &lt;waypoint&gt;</div>
<div class="line">            &lt;time&gt;0&lt;/time&gt;</div>
<div class="line">            &lt;pose&gt;2 -2 0.5 0 0 0&lt;/pose&gt;</div>
<div class="line">          &lt;/waypoint&gt;</div>
<div class="line">          &lt;waypoint&gt;</div>
<div class="line">            &lt;time&gt;5&lt;/time&gt;</div>
<div class="line">            &lt;pose&gt;2 -2 0.5 0 0 0&lt;/pose&gt;</div>
<div class="line">          &lt;/waypoint&gt;</div>
<div class="line">        &lt;/trajectory&gt;</div>
<div class="line">      &lt;/script&gt;</div>
<div class="line">    &lt;/actor&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;/world&gt;</div>
<div class="line">&lt;/sdf&gt;</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>The actor's vertical pose will be different on both simulators. That's because a hardcoded offset was removed on Gazebo and maintained on Gazebo classic for backwards compatibility.</dd></dl>
<h3><a class="anchor" id="path-relative-to-the-sdf-file"></a>
Path relative to the SDF file</h3>
<p>It's possible to use relative paths within SDF files to refer to other files in the same directory. This is recommended when creating files that work together and need to be relocatable.</p>
<p>For example, consider the following directory structure:</p>
<div class="fragment"><div class="line">/home/username/</div>
<div class="line">├── world.sdf</div>
<div class="line">└── models</div>
<div class="line">    └── model1</div>
<div class="line">        ├── model.sdf</div>
<div class="line">        └── meshes</div>
<div class="line">            └── mesh.dae</div>
</div><!-- fragment --><p>The world <code>world.sdf</code> can include <code>model1</code> as follows:</p>
<p><code>&lt;include&gt;models/model1&lt;/include&gt;</code></p>
<p>And <code>model.sdf</code> can refer to <code>mesh.dae</code> as:</p>
<p><code>&lt;uri&gt;meshes/mesh.dae&lt;/uri&gt;</code></p>
<h3><a class="anchor" id="path-relative-to-an-environment-variable"></a>
Path relative to an environment variable</h3>
<p>This method is useful if you don't know where the files will be located with respect to each other, and you have some control over the simulation's runtime environment. On either simulator, you can refer to resources relative to paths set on an environment variable.</p>
<p>Each simulator uses a different environment variable:</p>
<ul>
<li>Gazebo classic:<ul>
<li><code>GAZEBO_MODEL_PATH</code> for models</li>
<li><code>GAZEBO_RESOURCE_PATH</code> for worlds and some rendering resources</li>
</ul>
</li>
<li>Gazebo:<ul>
<li><code>GZ_SIM_RESOURCE_PATH</code> for worlds, models and other resources</li>
</ul>
</li>
</ul>
<p>For example, if you have the file structure above, you can set the environment variable to <code>/home/username/models</code>:</p>
<div class="fragment"><div class="line">export GAZEBO_MODEL_PATH=/home/username/models</div>
<div class="line">export GAZEBO_RESOURCE_PATH=/home/username/models</div>
<div class="line">export GZ_SIM_RESOURCE_PATH=/home/username/models</div>
</div><!-- fragment --><p>And inside <code>world.sdf</code> include the model with:</p>
<p><code>&lt;include&gt;model://model1&lt;/include&gt;</code></p>
<p>Also, <code>model.sdf</code> can refer to <code>mesh.dae</code> as:</p>
<p><code>&lt;uri&gt;model://model1/meshes/mesh.dae&lt;/uri&gt;</code></p>
<p>On both situations, the <code>model://</code> prefix will be substituted by <code>/home/username/models</code>.</p>
<p>You can also set several lookup paths separating them with <code>:</code>, for example:</p>
<p><code>export GZ_SIM_RESOURCE_PATH=/home/username/models:/home/username/another_project/models</code></p>
<h3><a class="anchor" id="absolute-paths"></a>
Absolute paths</h3>
<p>Finally, both simulators will accept absolute paths, for example:</p>
<p><code>&lt;include&gt;/home/username/models/model1&lt;/include&gt;</code></p>
<p>This method is not recommended, because the file most likely won't work if copied to a different computer. It also becomes inconvenient to move files to different directories.</p>
<h2><a class="anchor" id="plugins"></a>
Plugins</h2>
<p>Plugins are binary files compiled to use with a specific simulator. Plugins for Gazebo classic and Gazebo aren't usually compatible, so plugins will need to be specified for each simulator separately.</p>
<p>It's important to note that for both simulators, plugins compiled against a major version of the simulator can't be loaded by other major versions. The shared libraries will usually have the same name, so it's important to make sure you're loading the correct plugins.</p>
<h3><a class="anchor" id="official-plugins"></a>
Official plugins</h3>
<p>Both simulators are installed with several built-in plugins. <a href="https://github.com/osrf/gazebo/tree/gazebo11/plugins">Gazebo classic's plugins</a> and <a href="https://github.com/gazebosim/gz-sim/tree/gz-sim10/src/systems">Gazebo Sim's plugins</a> have different file names. For example, to use Gazebo classic's differential drive plugin, the user can refer to it as follows:</p>
<div class="fragment"><div class="line">&lt;model ...&gt;</div>
<div class="line">  &lt;plugin filename=&quot;libDiffDrivePlugin.so&quot; name=&quot;any_custom_name&quot;&gt;</div>
<div class="line">     ...</div>
<div class="line">  &lt;/plugin&gt;</div>
<div class="line">&lt;/model&gt;</div>
</div><!-- fragment --><p>On Gazebo, that would be:</p>
<div class="fragment"><div class="line">&lt;model ...&gt;</div>
<div class="line">   &lt;plugin filename=&quot;gz-sim-diff-drive-system&quot;</div>
<div class="line">     name=&quot;gz::sim::systems::DiffDrive&quot;&gt;</div>
<div class="line">     ...</div>
<div class="line">   &lt;/plugin&gt;</div>
<div class="line">&lt;/model&gt;</div>
</div><!-- fragment --><p>Note that besides the different file name, Gazebo also requires the C++ class to be defined in the <code>name</code> attribute.</p>
<p>Also keep in mind that plugins that offer similar functionality may accept different parameters for each simulator. Be sure to check the documentation of each plugin before using it.</p>
<h3><a class="anchor" id="custom-plugins"></a>
Custom plugins</h3>
<p>To load custom plugins, users need to set environment variables to the directory where that plugin is located. The variables are different for each simulator:</p>
<ul>
<li>Gazebo classic:<ul>
<li><code>GAZEBO_PLUGIN_PATH</code> for all plugin types.</li>
</ul>
</li>
<li>Gazebo:<ul>
<li><code>GZ_SIM_SYSTEM_PLUGIN_PATH</code> for Gazebo systems (world, model, sensor and visual plugins).</li>
<li><code>GZ_GUI_PLUGIN_PATH</code> for GUI plugins.</li>
</ul>
</li>
</ul>
<h3><a class="anchor" id="keeping-plugins-separate"></a>
Keeping plugins separate</h3>
<p>Trying to load a plugin from one simulator into the other will:</p>
<ul>
<li>Print an error message if the simulator can't find the plugin</li>
<li>Potentially crash if the simulator can find the plugin and tries to load it</li>
</ul>
<p>That's why it's recommended not to specify plugins for both simulators side-by-side on the same file. Instead, keep separate files and inject the plugins as needed.</p>
<p>There isn't a built-in mechanism on SDFormat to inject plugins into files yet, but users can make use of templating tools like <a href="https://github.com/gazebosim/gz-sim/blob/gz-sim10/tutorials/erb_template.md">ERB</a> and <a href="http://wiki.ros.org/xacro">xacro</a> to generate SDF files with the correct plugins.</p>
<h3><a class="anchor" id="default-plugins"></a>
Default plugins</h3>
<p>Gazebo is more modular than Gazebo classic, so most features are optional. For example, by default, Gazebo will load all the system plugins defined on the <code>~/.gz/sim/&lt;#&gt;/server.config</code> file and all GUI plugins defined on the <code>~/.gz/sim/&lt;#&gt;/gui.config</code> file. But the user can always remove plugins from those files, or choose different ones by adding <code>&lt;plugin&gt;</code> tags to the SDF file. (For more details, see the <a href="https://github.com/gazebosim/gz-sim/blob/gz-sim10/tutorials/server_config.md">Server configuration tutorial</a> and the <a href="https://github.com/gazebosim/gz-sim/blob/gz-sim10/tutorials/gui_config.md">GUI configuration tutorial</a>).</p>
<p>This is important to keep in mind when migrating your SDF files, because files that worked on Gazebo classic may need more plugins on Gazebo.</p>
<h2><a class="anchor" id="materials-1"></a>
Materials</h2>
<p>Gazebo does not support Ogre material files like Classic does, because Gazebo can be used with multiple rendering engines. Though, there is limited support for pre-defined materials, but arbitrary materials defined (below) within a <code>&lt;script&gt;</code> aren't supported:</p>
<div class="fragment"><div class="line">&lt;material&gt;</div>
<div class="line">  &lt;script&gt;</div>
<div class="line">    &lt;uri&gt;model://number1/materials/scripts&lt;/uri&gt;</div>
<div class="line">    &lt;uri&gt;model://number1/materials/textures&lt;/uri&gt;</div>
<div class="line">    &lt;name&gt;Number/One&lt;/name&gt;</div>
<div class="line">  &lt;/script&gt;</div>
<div class="line">&lt;/material&gt;</div>
</div><!-- fragment --><h3><a class="anchor" id="plain-colors"></a>
Plain colors</h3>
<p>To ease migration, Gazebo automatically parses plain solid colors defined in this material file <a href="https://github.com/osrf/gazebo/blob/gazebo11/media/materials/scripts/gazebo.material">gazebo.material</a>, if encountered like:</p>
<div class="fragment"><div class="line">&lt;material&gt;</div>
<div class="line">  &lt;script&gt;</div>
<div class="line">    &lt;uri&gt;file://media/materials/scripts/gazebo.material&lt;/uri&gt;</div>
<div class="line">    &lt;name&gt;Gazebo/Red&lt;/name&gt;</div>
<div class="line">  &lt;/script&gt;</div>
<div class="line">&lt;/material&gt;</div>
</div><!-- fragment --><p>But this automatic parsing capability is limited to plain solid colors, other colors would be rendered with a default &lt;material&gt; value. Eventually, to make your models compatible with both simulators, such material defining plain colors should be updated to use the <code>&lt;ambient&gt;</code>, <code>&lt;specular&gt;</code>, <code>&lt;emissive&gt;</code> and <code>&lt;diffuse&gt;</code> tags as needed:</p>
<div class="fragment"><div class="line">&lt;material&gt;</div>
<div class="line">  &lt;ambient&gt;1 0 0 1&lt;/ambient&gt;</div>
<div class="line">  &lt;diffuse&gt;1 0 0 1&lt;/diffuse&gt;</div>
<div class="line">  &lt;specular&gt;0.1 0.1 0.1 1&lt;/specular&gt;</div>
<div class="line">&lt;/material&gt;</div>
</div><!-- fragment --><h3><a class="anchor" id="textures"></a>
Textures</h3>
<p>If an Ogre material script is being used to define a texture, there are a couple alternatives.</p>
<p>If using mesh files, the texture can be embedded into it. The advantage is that this works for both simulators. Some examples:</p>
<ul>
<li><a href="https://app.gazebosim.org/OpenRobotics/fuel/models/DeskChair">OBJ + MTL</a></li>
<li><a href="https://app.gazebosim.org/OpenRobotics/fuel/models/Lamp%20Post">COLLADA</a></li>
</ul>
<p>For primitive shapes or even meshes, you can pass the texture as the albedo map. If you want the model to be compatible with both Classic and Gazebo, you can specify both the script and the albedo map.</p>
<div class="fragment"><div class="line">&lt;material&gt;</div>
<div class="line">  &lt;pbr&gt;</div>
<div class="line">    &lt;metal&gt;</div>
<div class="line">      &lt;albedo_map&gt;texture.png&lt;/albedo_map&gt;</div>
<div class="line">    &lt;/metal&gt;</div>
<div class="line">  &lt;/pbr&gt;</div>
<div class="line">&lt;/material&gt;</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
      </div>
    </main>
  </div>
</body>
