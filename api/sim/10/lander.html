<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="keywords" content="Gazebo Sim">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gazebo Sim: Create a lander vehicle</title>
    <script type="text/javascript" src="https://gazebosim.org/assets/doxygen/dynsections.js"></script>
    <script type="text/javascript" src="jquery.js"></script>
    <link rel="icon" type="image/x-icon" href="https://gazebosim.org/assets/icon/favicon.ico">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.deep_orange-blue.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script>
    <link href="https://gazebosim.org/assets/doxygen/doxygen.css" rel="stylesheet" type="text/css">
  </head>
    <script type="text/javascript">
      /* Replace all the "permalink" &#9670;&nbsp; icons with a unicode link
        symbol.*/
      $(document).ready(function() {
        var elems = document.getElementsByClassName("permalink");
        for (var i = 0; i < elems.length; ++i) {
          elems[i].firstChild.innerHTML="&#x1f517;";
          elems[i].firstChild.style.fontSize="18px";
        }
      });
    </script>
  </head>
<body>
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer">
    <div class="mdl-layout__drawer mdl-color--grey-100 mdl-color-text--blue-grey-50">
      <header class="mdl-color--grey-100">
        <a href="index.html"><img width="60px" src="https://gazebosim.org/assets/doxygen/gazebo_logo.svg"/></a>
        <h1 class="project_title">Gazebo Sim</h1>
        <h2>API Reference</h2>
        <div class="version">
        10.0.0
        </div>
      </header>
      <!-- NOTE: If you add a link to a doxygen generated page, then make
                 sure to update the required_html_fils list in
                 GzCreateDocs.cmake -->
      <nav class="gz-navigation mdl-navigation">
        <a class="mdl-navigation__link" href="tutorials.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Tutorials</a>
        <a id="class_menu" class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">library_books</i>Classes</a>
        <a id="namespaces_menu"class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">toc</i>Namespaces</a>
        <a class="mdl-navigation__link" href="files.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Files</a>
        <a class="mdl-navigation__link" target="_blank"
           href="http://gazebosim.org">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">launch</i>Gazebo Website</a>
      </nav>
      <!-- classes sub menu -->
      <ul for="class_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link" href="classes.html">Index</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="annotated.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="hierarchy.html">Hierarchy</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions.html">Members: All</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_func.html">Members: Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_vars.html">Members: Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_type.html">Members: Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_enum.html">Members: Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_eval.html">Members: Enumerator</a>
        </li>
      </ul>
      <!-- namespaces sub menu -->
      <ul for="namespaces_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespaces.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers.html">Members</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_func.html">Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_type.html">Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_vars.html">Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_enum.html">Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_eval.html">Enumerator</a>
        </li>
      </ul>
    </div>
    <main class="mdl-layout__content mdl-color--white">
    <div id="top">
<!-- Generated by Doxygen 1.9.8 -->
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Create a lander vehicle</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="overview-6"></a>
Overview</h1>
<p>This tutorial explains how to create and load an underwater lander vehicle in Gazebo. This type of vehicles don't usually have control surfaces or thrusters. They typically sink until they reach the seafloor or certain depth and go back to the surface while they collect sensor measurements.</p>
<h2><a class="anchor" id="related-tutorials-4"></a>
Related tutorials</h2>
<p><a class="el" href="create_vehicle.html">Create a maritime vehicle</a></p>
<p><a class="el" href="adding_visuals.html">Adding visuals</a></p>
<p><a class="el" href="frame_reference.html">Frame of reference</a></p>
<p><a class="el" href="adding_system_plugins.html">Adding system plugins</a></p>
<p><a class="el" href="theory_buoyancy.html">Buoyancy</a></p>
<p><a class="el" href="theory_hydrodynamics.html">Hydrodynamics</a></p>
<h1><a class="anchor" id="create-your-vehicle"></a>
Create your vehicle</h1>
<p>As an example, we'll go through the process of creating an Inkfish underwater lander vehicle.</p>
<h2><a class="anchor" id="basic-sdf"></a>
Basic SDF</h2>
<p>Create a workspace to store your brand new model named <code>my_lander</code>.</p>
<div class="fragment"><div class="line">mkdir -p ~/gazebo_maritime/models/my_lander &amp;&amp; cd ~/gazebo_maritime/models/my_lander</div>
</div><!-- fragment --><p>Download the <code>model.config</code> file and copy it within that directory:</p>
<div class="fragment"><div class="line">wget https://raw.githubusercontent.com/gazebosim/gz-sim/gz-sim10/tutorials/files/lander/model.config -O ~/gazebo_maritime/models/my_lander/model.config</div>
</div><!-- fragment --><p>In its simple version, the lander does not have any moving pieces, so the SDF model only has one single link, <code>base_link</code> in our case.</p>
<p>Create a <code>model.sdf</code> and paste the following content:</p>
<div class="fragment"><div class="line">&lt;?<span class="keyword">xml</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.0&quot;</span>?&gt;</div>
<div class="line">&lt;<span class="keywordtype">sdf</span> <span class="keyword">version</span>=<span class="stringliteral">&quot;1.6&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">model</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;lander&quot;</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">link</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;base_link&quot;</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">inertial</span>&gt;</div>
<div class="line">        <span class="comment">&lt;!-- Center of mass --&gt;</span></div>
<div class="line">        &lt;<span class="keywordtype">pose</span>&gt;0 0 -0.982494 0 0 0&lt;/<span class="keywordtype">pose</span>&gt;</div>
<div class="line"> </div>
<div class="line">        &lt;<span class="keywordtype">mass</span>&gt;1209.175&lt;/<span class="keywordtype">mass</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">inertia</span>&gt;</div>
<div class="line">          &lt;<span class="keywordtype">ixx</span>&gt;205.227945746&lt;/<span class="keywordtype">ixx</span>&gt;</div>
<div class="line">          &lt;<span class="keywordtype">ixy</span>&gt;0&lt;/<span class="keywordtype">ixy</span>&gt;</div>
<div class="line">          &lt;<span class="keywordtype">ixz</span>&gt;0&lt;/<span class="keywordtype">ixz</span>&gt;</div>
<div class="line">          &lt;<span class="keywordtype">iyy</span>&gt;412.254844006&lt;/<span class="keywordtype">iyy</span>&gt;</div>
<div class="line">          &lt;<span class="keywordtype">iyz</span>&gt;0&lt;/<span class="keywordtype">iyz</span>&gt;</div>
<div class="line">          &lt;<span class="keywordtype">izz</span>&gt;383.659583213&lt;/<span class="keywordtype">izz</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">inertia</span>&gt;</div>
<div class="line">      &lt;/<span class="keywordtype">inertial</span>&gt;</div>
<div class="line"> </div>
<div class="line">      &lt;<span class="keywordtype">visual</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;chassis_visual&quot;</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">          &lt;<span class="keywordtype">box</span>&gt;</div>
<div class="line">            &lt;<span class="keywordtype">size</span>&gt;1.325 1.1503 1.5&lt;/<span class="keywordtype">size</span>&gt;</div>
<div class="line">          &lt;/<span class="keywordtype">box</span>&gt;</div>
<div class="line">        &lt;/<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">      &lt;/<span class="keywordtype">visual</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">link</span>&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;/<span class="keywordtype">model</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">sdf</span>&gt;</div>
</div><!-- fragment --><p>We can now test it in Gazebo. Launch it with:</p>
<div class="fragment"><div class="line">gz sim ~/gazebo_maritime/models/my_lander/model.sdf</div>
</div><!-- fragment --><p>You should see your model visualized as a box.</p>
<div class="image">
<img src="simple_lander.png" alt=""/>
</div>
<h2><a class="anchor" id="adding-visuals"></a>
Adding visuals</h2>
<p>Let's now add nicer-looking visuals to our lander. Download the following <code>COLLADA</code> mesh file from here.</p>
<div class="fragment"><div class="line">mkdir ~/gazebo_maritime/models/my_lander/meshes</div>
<div class="line">wget https://raw.githubusercontent.com/gazebosim/gz-sim/gz-sim10/tutorials/files/lander/inkfish-lander.dae -O ~/gazebo_maritime/models/my_lander/meshes/inkfish-lander.dae</div>
</div><!-- fragment --><p>Replace the <code>chassis_visual</code> element in your <code>model.sdf</code> with the following block:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">visual</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;chassis_visual&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">mesh</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">uri</span>&gt;<span class="keyword">meshes</span>/<span class="keyword">inkfish-lander.dae</span>&lt;/<span class="keywordtype">uri</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">mesh</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">visual</span>&gt;</div>
</div><!-- fragment --><p>And launch Gazebo to see the results:</p>
<div class="fragment"><div class="line">gz sim ~/gazebo_maritime/models/my_lander/model.sdf</div>
</div><!-- fragment --><p>Your box should now be replaced with a better looking mesh.</p>
<div class="image">
<img src="lander_visuals.png" alt=""/>
</div>
<h2><a class="anchor" id="checking-frame-of-reference"></a>
Checking frame of reference</h2>
<p>Launch your lander in Gazebo as we did before:</p>
<div class="fragment"><div class="line">gz sim ~/gazebo_maritime/models/my_lander/model.sdf</div>
</div><!-- fragment --><p>You can visualize the frame of reference of your vehicle by loading the plugin <code>Transform Control</code> from the GUI.</p>
<div class="image">
<img src="gui_transform_control.png" alt=""/>
</div>
<p>Then, click on the vehicle, and then, click on the <code>Translate mode</code> icon. You'll now visualize your lander frame of reference. As this is the expected frame of reference, we won't need to apply changes in the COLLADA mesh or add any <code>&lt;pose&gt;</code> offset to our <code>model.sdf</code>.</p>
<h2><a class="anchor" id="adding-plugins"></a>
Adding plugins</h2>
<h3><a class="anchor" id="buoyancy"></a>
Buoyancy</h3>
<p>We are going to start extending our model adding buoyancy properties. For that, we need to do two things:</p>
<ol type="1">
<li>Create a Gazebo world SDF file and load the buoyancy world plugin.</li>
<li>Add <code>&lt;collision&gt;</code> elements to our lander model SDF.</li>
</ol>
<p>Let's start with the world. Download the following world:</p>
<div class="fragment"><div class="line">mkdir -p ~/gazebo_maritime/worlds</div>
<div class="line">wget https://raw.githubusercontent.com/gazebosim/gz-sim/gz-sim10/tutorials/files/lander/buoyant_lander.sdf -O ~/gazebo_maritime/worlds/buoyant_lander.sdf</div>
<div class="line">export GZ_SIM_RESOURCE_PATH=:$HOME/gazebo_maritime/models</div>
</div><!-- fragment --><p>Now, open your <code>~/gazebo_maritime/models/my_lander/model.sdf</code> and add the low volume outer collision elements to the <code>base_link</code>:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">collision</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;collision_top&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">pose</span>&gt;0 0 1.5 0 0 0&lt;/<span class="keywordtype">pose</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">box</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">size</span>&gt;1.325 1.1503 0.000001&lt;/<span class="keywordtype">size</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">box</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">collision</span>&gt;</div>
<div class="line"> </div>
<div class="line">&lt;<span class="keywordtype">collision</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;collision_rear&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">pose</span>&gt;0.6625 0 0.75 0 0 0&lt;/<span class="keywordtype">pose</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">box</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">size</span>&gt;0.000001 1.1503 1.5&lt;/<span class="keywordtype">size</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">box</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">collision</span>&gt;</div>
<div class="line"> </div>
<div class="line">&lt;<span class="keywordtype">collision</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;collision_front&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">pose</span>&gt;-0.6625 0 0.75 0 0 0&lt;/<span class="keywordtype">pose</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">box</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">size</span>&gt;0.000001 1.1503 1.5&lt;/<span class="keywordtype">size</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">box</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">collision</span>&gt;</div>
<div class="line"> </div>
<div class="line">&lt;<span class="keywordtype">collision</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;collision_starboard&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">pose</span>&gt;0 0.57515 0.75 0 0 0&lt;/<span class="keywordtype">pose</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">box</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">size</span>&gt;1.325 0.000001 1.5&lt;/<span class="keywordtype">size</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">box</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">collision</span>&gt;</div>
<div class="line"> </div>
<div class="line">&lt;<span class="keywordtype">collision</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;collision_port&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">pose</span>&gt;0 -0.57515 0.75 0 0 0&lt;/<span class="keywordtype">pose</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">box</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">size</span>&gt;1.325 0.000001 1.5&lt;/<span class="keywordtype">size</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">box</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">collision</span>&gt;</div>
<div class="line"> </div>
<div class="line">&lt;<span class="keywordtype">collision</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;collision_bottom&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">pose</span>&gt;0 0 0 0 0 0&lt;/<span class="keywordtype">pose</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">box</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">size</span>&gt;1.325 1.1503 0.000001&lt;/<span class="keywordtype">size</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">box</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">collision</span>&gt;</div>
</div><!-- fragment --><p>You can now launch Gazebo:</p>
<div class="fragment"><div class="line">gz sim ~/gazebo_maritime/worlds/buoyant_lander.sdf</div>
</div><!-- fragment --><p>And visualize collisions by right-clicking on the lander, and the, <code>View</code> -&gt; <code>Collisions</code>.</p>
<div class="image">
<img src="lander_collisions.png" alt=""/>
</div>
<p>If you hit play, your lander will sink as expected. Although the buoyancy plugin is loaded, notice that all the collision elements that we added are low-volume. This is on purpose to make sure that our model can collide with obstacles. However, it's generating very little buoyancy.</p>
<p>Let's now compute the reference volume that will make the lander neutrally buoyant.</p>
<p>$$volume\_neutral = \frac{mass}{waterDensity} = \frac{1209.175}{1025} = 1.1796829268292683$$</p>
<p>Now, let's account for the volume that our lander already has thanks to the low-volume outer collision elements:</p>
<p>$$outer\_volume = 2*1.1325*1.1503*0.000001 + 2*0.000001*1.1503*1.5 + 2*1.325* 0.000001*1.5 = 1.00313295e-05$$</p>
<p>Let's now compute the volume of the main buoyancy <code>&lt;collision&gt;</code> element:</p>
<p>$$main\_buoyancy\_volume = 1.1796829268292683 - 1.00313295e-05 = 1.1796728954997684$$</p>
<p>Let's verify that our lander is neutrally buoyant now. Add the following collision element to your <code>base_link</code>:</p>
<div class="fragment"><div class="line"><span class="comment">&lt;!-- Center of buoyancy --&gt;</span></div>
<div class="line">&lt;<span class="keywordtype">collision</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;buoyancy&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">pose</span>&gt;0 0 0 0 0 0&lt;/<span class="keywordtype">pose</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">box</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">size</span>&gt;1.1796728954997684 1 1&lt;/<span class="keywordtype">size</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">box</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">collision</span>&gt;</div>
</div><!-- fragment --><p>And launch Gazebo:</p>
<div class="fragment"><div class="line">gz sim ~/gazebo_maritime/worlds/buoyant_lander.sdf</div>
</div><!-- fragment --><p>Hit play, and your lander should now maintain depth!</p>
<p>This an example to illustrate how to calculate this reference value, however a lander is normally designed to sink.</p>
<p>Change the buoyancy plugin to the following value to be more realistic:</p>
<div class="fragment"><div class="line"><span class="comment">&lt;!-- Center of buoyancy --&gt;</span></div>
<div class="line">&lt;<span class="keywordtype">collision</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;buoyancy&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">pose</span>&gt;0 0 0 0 0 0&lt;/<span class="keywordtype">pose</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">box</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">size</span>&gt;1.14 1 1&lt;/<span class="keywordtype">size</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">box</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">collision</span>&gt;</div>
</div><!-- fragment --><p>And launch Gazebo:</p>
<div class="fragment"><div class="line">gz sim ~/gazebo_maritime/worlds/buoyant_lander.sdf</div>
</div><!-- fragment --><p>Hit play and the lander will slowly sink and hit the seafloor.</p>
<h3><a class="anchor" id="hydrodynamics"></a>
Hydrodynamics</h3>
<p>As an underwater vehicle, the lander should be influenced by the water as it moves. We can do that by attaching the <code>hydrodynamics</code> plugin to our lander. Add the next SDF block to your <code>model.sdf</code>. Note that we have empirically adjusted its values. Follow the <a href="https://gazebosim.org/api/sim/8/theory_hydrodynamics.html">hydrodynamics tutorial</a> for recommendations about how to tune its values.</p>
<div class="fragment"><div class="line"><span class="comment">&lt;!-- Hydrodynamics --&gt;</span></div>
<div class="line">&lt;<span class="keywordtype">plugin</span></div>
<div class="line">  <span class="keyword">filename</span>=<span class="stringliteral">&quot;gz-sim-hydrodynamics-system&quot;</span></div>
<div class="line">  <span class="keyword">name</span>=<span class="stringliteral">&quot;gz::sim::systems::Hydrodynamics&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">link_name</span>&gt;<span class="keyword">base_link</span>&lt;/<span class="keywordtype">link_name</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">xDotU</span>&gt;-4.876161&lt;/<span class="keywordtype">xDotU</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">yDotV</span>&gt;-126.324739&lt;/<span class="keywordtype">yDotV</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">zDotW</span>&gt;-126.324739&lt;/<span class="keywordtype">zDotW</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">kDotP</span>&gt;0&lt;/<span class="keywordtype">kDotP</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">mDotQ</span>&gt;-33.46&lt;/<span class="keywordtype">mDotQ</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">nDotR</span>&gt;-33.46&lt;/<span class="keywordtype">nDotR</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">xUabsU</span>&gt;-6.2282&lt;/<span class="keywordtype">xUabsU</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">xU</span>&gt;0&lt;/<span class="keywordtype">xU</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">yVabsV</span>&gt;-601.27&lt;/<span class="keywordtype">yVabsV</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">yV</span>&gt;0&lt;/<span class="keywordtype">yV</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">zWabsW</span>&gt;-601.27&lt;/<span class="keywordtype">zWabsW</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">zW</span>&gt;0&lt;/<span class="keywordtype">zW</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">kPabsP</span>&gt;-0.1916&lt;/<span class="keywordtype">kPabsP</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">kP</span>&gt;0&lt;/<span class="keywordtype">kP</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">mQabsQ</span>&gt;-632.698957&lt;/<span class="keywordtype">mQabsQ</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">mQ</span>&gt;0&lt;/<span class="keywordtype">mQ</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">nRabsR</span>&gt;-632.698957&lt;/<span class="keywordtype">nRabsR</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">nR</span>&gt;0&lt;/<span class="keywordtype">nR</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">plugin</span>&gt;</div>
</div><!-- fragment --><h3><a class="anchor" id="drop-weight"></a>
Drop weight</h3>
<p>A common feature in maritime landers is to include a drop weight device. When this device is enabled, some part of the vehicle is detached from the main chassis. At this point, the vehicle becomes positive buoyant, and starts moving up towards the water surface.</p>
<p>In order to simulate this behavior, we'll need to make two changes to our lander model:</p>
<ol type="1">
<li>Add a new separate link to act as the drop weight.</li>
<li>Attach a plugin to disconnect the previous link on demand.</li>
</ol>
<p>Let's add the following SDF block to your <code>model.sdf</code>:</p>
<div class="fragment"><div class="line"><span class="comment">&lt;!-- Drop weight --&gt;</span></div>
<div class="line">&lt;<span class="keywordtype">link</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;drop_weight&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">pose</span>&gt;0 0 0.25 0 0 0&lt;/<span class="keywordtype">pose</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">visual</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;drop_weight_visual&quot;</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">box</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">size</span>&gt;0.5 0.5 0.5&lt;/<span class="keywordtype">size</span>&gt;</div>
<div class="line">      &lt;/<span class="keywordtype">box</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">visual</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">collision</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;drop_weight_collision&quot;</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">box</span>&gt;</div>
<div class="line">        &lt;<span class="keywordtype">size</span>&gt;0.5 0.5 0.000001&lt;/<span class="keywordtype">size</span>&gt;</div>
<div class="line">      &lt;/<span class="keywordtype">box</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">collision</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">inertial</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">mass</span>&gt;120&lt;/<span class="keywordtype">mass</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">inertial</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">link</span>&gt;</div>
<div class="line"> </div>
<div class="line">&lt;<span class="keywordtype">plugin</span></div>
<div class="line">  <span class="keyword">filename</span>=<span class="stringliteral">&quot;gz-sim-detachable-joint-system&quot;</span></div>
<div class="line">  <span class="keyword">name</span>=<span class="stringliteral">&quot;gz::sim::systems::DetachableJoint&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">parent_link</span>&gt;<span class="keyword">base_link</span>&lt;/<span class="keywordtype">parent_link</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">child_model</span>&gt;<span class="keyword">__model__</span>&lt;/<span class="keywordtype">child_model</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">child_link</span>&gt;<span class="keyword">drop_weight</span>&lt;/<span class="keywordtype">child_link</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">topic</span>&gt;/<span class="keyword">model</span>/<span class="keyword">lander</span>/<span class="keyword">drop_weight</span>&lt;/<span class="keywordtype">topic</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">plugin</span>&gt;</div>
</div><!-- fragment --><p>The mass of the drop weight changes the buoyancy properties of the lander. Let's calculate the reference values:</p>
<p>$$volume\_neutral\_with\_dropweight = \frac{mass}{waterDensity} = \frac{1209.175 + 120}{1025} = 1.2967560975609755$$</p>
<p>$$volume\_neutral\_without\_dropweight = \frac{mass}{waterDensity} = \frac{1209.175}{1025} = 1.1796829268292683$$</p>
<p>We're looking for a volume that's lower than <code>volume_neutral_with_dropweight</code> to cause the lander to sink from its initial configuration, and bigger than <code>volume_neutral_without_dropweight</code> to cause the lander to go back to the surface when the drop weight is enabled. Let's choose <code>1.24</code> as the volume for our main buoyancy collision element. Replace the <code>buoyancy</code> collision element with:</p>
<div class="fragment"><div class="line"><span class="comment">&lt;!-- Center of buoyancy --&gt;</span></div>
<div class="line">&lt;<span class="keywordtype">collision</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;buoyancy&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">pose</span>&gt;0 0 0 0 0 0&lt;/<span class="keywordtype">pose</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">box</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">size</span>&gt;1.24 1 1&lt;/<span class="keywordtype">size</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">box</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">geometry</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">collision</span>&gt;</div>
</div><!-- fragment --><p>And launch Gazebo:</p>
<div class="fragment"><div class="line">gz sim ~/gazebo_maritime/worlds/buoyant_lander.sdf</div>
</div><!-- fragment --><p>Hit play and observe how the lander sinks until it hits the seafloor. Then, enable the drop weight to detach the extra link:</p>
<div class="fragment"><div class="line">gz topic -t &quot;/model/lander/drop_weight&quot; -m gz.msgs.Empty -p &quot;unused: true&quot;</div>
</div><!-- fragment --><p>Observe how your lander comes to the surface. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
      </div>
    </main>
  </div>
</body>
