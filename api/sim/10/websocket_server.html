<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="keywords" content="Gazebo Sim">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gazebo Sim: Websocket server for gzweb</title>
    <script type="text/javascript" src="https://gazebosim.org/assets/doxygen/dynsections.js"></script>
    <script type="text/javascript" src="jquery.js"></script>
    <link rel="icon" type="image/x-icon" href="https://gazebosim.org/assets/icon/favicon.ico">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.deep_orange-blue.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script>
    <link href="https://gazebosim.org/assets/doxygen/doxygen.css" rel="stylesheet" type="text/css">
  </head>
    <script type="text/javascript">
      /* Replace all the "permalink" &#9670;&nbsp; icons with a unicode link
        symbol.*/
      $(document).ready(function() {
        var elems = document.getElementsByClassName("permalink");
        for (var i = 0; i < elems.length; ++i) {
          elems[i].firstChild.innerHTML="&#x1f517;";
          elems[i].firstChild.style.fontSize="18px";
        }
      });
    </script>
  </head>
<body>
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer">
    <div class="mdl-layout__drawer mdl-color--grey-100 mdl-color-text--blue-grey-50">
      <header class="mdl-color--grey-100">
        <a href="index.html"><img width="60px" src="https://gazebosim.org/assets/doxygen/gazebo_logo.svg"/></a>
        <h1 class="project_title">Gazebo Sim</h1>
        <h2>API Reference</h2>
        <div class="version">
        10.0.0~pre2
        </div>
      </header>
      <!-- NOTE: If you add a link to a doxygen generated page, then make
                 sure to update the required_html_fils list in
                 GzCreateDocs.cmake -->
      <nav class="gz-navigation mdl-navigation">
        <a class="mdl-navigation__link" href="tutorials.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Tutorials</a>
        <a id="class_menu" class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">library_books</i>Classes</a>
        <a id="namespaces_menu"class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">toc</i>Namespaces</a>
        <a class="mdl-navigation__link" href="files.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Files</a>
        <a class="mdl-navigation__link" target="_blank"
           href="http://gazebosim.org">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">launch</i>Gazebo Website</a>
      </nav>
      <!-- classes sub menu -->
      <ul for="class_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link" href="classes.html">Index</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="annotated.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="hierarchy.html">Hierarchy</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions.html">Members: All</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_func.html">Members: Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_vars.html">Members: Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_type.html">Members: Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_enum.html">Members: Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_eval.html">Members: Enumerator</a>
        </li>
      </ul>
      <!-- namespaces sub menu -->
      <ul for="namespaces_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespaces.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers.html">Members</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_func.html">Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_type.html">Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_vars.html">Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_enum.html">Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_eval.html">Enumerator</a>
        </li>
      </ul>
    </div>
    <main class="mdl-layout__content mdl-color--white">
    <div id="top">
<!-- Generated by Doxygen 1.9.8 -->
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Websocket server for gzweb</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The websocket server system starts up a websocket server for the web-based Gazebo visualization tool, <a href="https://github.com/gazebo-web/gzweb">gzweb</a>.</p>
<h2><a class="anchor" id="usage-1"></a>
Usage</h2>
<p>The websocket server system can be included in an world SDF file inside the <code>&lt;world&gt;</code> SDF element like other systems.</p>
<p>A simple example is shown below:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">plugin</span></div>
<div class="line">    <span class="keyword">filename</span>=<span class="stringliteral">&quot;gz-sim-websocket-server-system&quot;</span></div>
<div class="line">    <span class="keyword">name</span>=<span class="stringliteral">&quot;gz::sim::systems::WebsocketServer&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">port</span>&gt;9002&lt;/<span class="keywordtype">port</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">publication_hz</span>&gt;30&lt;/<span class="keywordtype">publication_hz</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">max_connections</span>&gt;-1&lt;/<span class="keywordtype">max_connections</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">plugin</span>&gt;</div>
</div><!-- fragment --><p>In this example, the websocket server will be launched on port 9002, the data published to gzweb are throttled at 30Hz, and the server has no limit on the maximum number of client connections. Authorization and SSL settings can also be configured.</p>
<p>See more information on the plugin parameters and how to launch gzweb in the <a href="https://github.com/gazebosim/gz-sim/blob/gz-sim10/examples/scripts/websocket_server">websocket server demo</a></p>
<div class="image">
<img src="fuel_visualization_gzweb.png" alt=""/>
</div>
<h3><a class="anchor" id="launch-websocket-server-separately-from-gazebo"></a>
Launch websocket server separately from Gazebo</h3>
<p>It is possible to launch the websocket server separately while Gazebo is running. This can be done by making use of gz-sim's <code>/world/&lt;world_name&gt;/system/add</code> service. For example:</p>
<ol type="1">
<li><p class="startli">Launch <code>shapes.sdf</code> world</p>
<div class="fragment"><div class="line">gz sim -v 4 shapes.sdf -s</div>
</div><!-- fragment --></li>
</ol>
<ol type="1">
<li><p class="startli">In another terminal, make a request to the gz-sim service to add the websocket server system</p>
<div class="fragment"><div class="line">gz service -s /world/shapes/entity/system/add --reqtype gz.msgs.EntityPlugin_V --reptype gz.msgs.Boolean --timeout 2000 --req &#39;plugins: {name: &quot;gz::sim::systems::WebsocketServer&quot;, filename: &quot;gz-sim-websocket-server-system&quot;, innerxml: &quot;&lt;port&gt;9002&lt;/port&gt;&lt;publication_hz&gt;30&lt;/publication_hz&gt;&lt;max_connections&gt;-1&lt;/max_connections&gt;&quot;}&#39;</div>
</div><!-- fragment --><p class="startli">Check the console output in the terminal that you used to launch gz sim and verify that the websocket server is started.</p>
</li>
</ol>
<h2><a class="anchor" id="migrating-from-gz-launch"></a>
Migrating from gz-launch</h2>
<p>The websocket server implementation was migrated from gz-launch as gz-launch is deprecated in Gazebo Jetty. It is converted to a gz-sim system and offers the same functionality as the one in gz-launch. All websocket server plugin parameters that were available in gz-launch are supported in the gz-sim system.</p>
<p>In gz-launch, the websocket server exists in the form of a "gz-launch plugin", which can be started from a launch file, see the example <a href="https://github.com/gazebosim/gz-launch/blob/gz-sim10/examples/websocket.gzlaunch">websocket.gzlaunch</a> file.</p>
<p>Specifically, the gz-launch plugin has the following syntax:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">plugin</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;gz::launch::WebsocketServer&quot;</span></div>
<div class="line">        <span class="keyword">filename</span>=<span class="stringliteral">&quot;gz-launch-websocket-server&quot;</span>&gt;</div>
<div class="line">  ...</div>
<div class="line">&lt;/<span class="keywordtype">plugin</span>&gt;</div>
</div><!-- fragment --><p>Now that in gz-sim, the websocket server is a gz-sim system, simply take the contents of the gz-launch plugin, add them to your SDF world file, and change the plugin name and filename to:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">plugin</span></div>
<div class="line">    <span class="keyword">filename</span>=<span class="stringliteral">&quot;gz-sim-websocket-server-system&quot;</span></div>
<div class="line">    <span class="keyword">name</span>=<span class="stringliteral">&quot;gz::sim::systems::WebsocketServer&quot;</span>&gt;</div>
<div class="line">  ...</div>
<div class="line">&lt;/<span class="keywordtype">plugin</span>&gt;</div>
</div><!-- fragment --><p>Launch the SDF world file as using by running <code>gz sim &lt;path_to_sdf&gt;</code>, the websocket server should be launched together with Gazebo. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
      </div>
    </main>
  </div>
</body>
