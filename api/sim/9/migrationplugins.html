<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="keywords" content="Gazebo Sim">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gazebo Sim: Migration from Gazebo Classic: Plugins</title>
    <script type="text/javascript" src="https://gazebosim.org/assets/doxygen/dynsections.js"></script>
    <script type="text/javascript" src="jquery.js"></script>
    <link rel="icon" type="image/x-icon" href="https://gazebosim.org/assets/icon/favicon.ico">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.deep_orange-blue.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script>
    <link href="https://gazebosim.org/assets/doxygen/doxygen.css" rel="stylesheet" type="text/css">
  </head>
    <script type="text/javascript">
      /* Replace all the "permalink" &#9670;&nbsp; icons with a unicode link
        symbol.*/
      $(document).ready(function() {
        var elems = document.getElementsByClassName("permalink");
        for (var i = 0; i < elems.length; ++i) {
          elems[i].firstChild.innerHTML="&#x1f517;";
          elems[i].firstChild.style.fontSize="18px";
        }
      });
    </script>
  </head>
<body>
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer">
    <div class="mdl-layout__drawer mdl-color--grey-100 mdl-color-text--blue-grey-50">
      <header class="mdl-color--grey-100">
        <a href="index.html"><img width="60px" src="https://gazebosim.org/assets/doxygen/gazebo_logo.svg"/></a>
        <h1 class="project_title">Gazebo Sim</h1>
        <h2>API Reference</h2>
        <div class="version">
        9.0.0
        </div>
      </header>
      <!-- NOTE: If you add a link to a doxygen generated page, then make
                 sure to update the required_html_fils list in
                 GzCreateDocs.cmake -->
      <nav class="gz-navigation mdl-navigation">
        <a class="mdl-navigation__link" href="tutorials.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Tutorials</a>
        <a id="class_menu" class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">library_books</i>Classes</a>
        <a id="namespaces_menu"class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">toc</i>Namespaces</a>
        <a class="mdl-navigation__link" href="files.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Files</a>
        <a class="mdl-navigation__link" target="_blank"
           href="http://gazebosim.org">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">launch</i>Gazebo Website</a>
      </nav>
      <!-- classes sub menu -->
      <ul for="class_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link" href="classes.html">Index</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="annotated.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="hierarchy.html">Hierarchy</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions.html">Members: All</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_func.html">Members: Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_vars.html">Members: Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_type.html">Members: Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_enum.html">Members: Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_eval.html">Members: Enumerator</a>
        </li>
      </ul>
      <!-- namespaces sub menu -->
      <ul for="namespaces_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespaces.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers.html">Members</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_func.html">Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_type.html">Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_vars.html">Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_enum.html">Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_eval.html">Enumerator</a>
        </li>
      </ul>
    </div>
    <main class="mdl-layout__content mdl-color--white">
    <div id="top">
<!-- Generated by Doxygen 1.9.8 -->
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Migration from Gazebo Classic: Plugins</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Gazebo Classic supports <a href="http://gazebosim.org/tutorials?tut=plugins_hello_world&amp;cat=write_plugin">6 different C++ plugin types</a>, each providing access to different parts of the API, like physics, rendering, sensors, GUI, etc. Due to Gazebo Sim's architecture based on an <a href="https://en.wikipedia.org/wiki/Entity_component_system">ECS</a> , plugin interfaces are somewhat different, but more varied and in many cases much more powerful. Some plugins in Gazebo are systems within Sim, while others are specific plugin types from other Gazebo libraries.</p>
<dl class="section note"><dt>Note</dt><dd>Plugin types other than systems may be added to Gazebo in the future.</dd></dl>
<p>For example, plugins which get and set properties of simulation entities would be Gazebo systems. On the other hand, there are now plugin interfaces which didn't exist in Gazebo Classic, such as integrating a new physics or rendering engine, and these can be also used in projects outside of Gazebo.</p>
<p>Take a look at the comparison below:</p>
<hr  />
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Classic plugin   </th><th class="markdownTableHeadNone">Features   </th><th class="markdownTableHeadNone">Gazebo equivalent   </th><th class="markdownTableHeadNone">Differences    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">World   </td><td class="markdownTableBodyNone">Get/set properties of the world and its children   </td><td class="markdownTableBodyNone">Gazebo system   </td><td class="markdownTableBodyNone">Get/set components.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Model   </td><td class="markdownTableBodyNone">Get/set properties of the model and its children   </td><td class="markdownTableBodyNone">Gazebo system   </td><td class="markdownTableBodyNone">Get/set components.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Visual   </td><td class="markdownTableBodyNone">Get/set properties of the visual and its children   </td><td class="markdownTableBodyNone">Gazebo system   </td><td class="markdownTableBodyNone">Get/set components.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Sensor   </td><td class="markdownTableBodyNone">Get/set sensor properties and readings   </td><td class="markdownTableBodyNone">Gazebo system   </td><td class="markdownTableBodyNone">Get/set components.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">World / Model   </td><td class="markdownTableBodyNone">Access physics-engine-specific features   </td><td class="markdownTableBodyNone">Physics plugin   </td><td class="markdownTableBodyNone">Loaded by gz-physics    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Visual   </td><td class="markdownTableBodyNone">Access rendering-engine-specific features   </td><td class="markdownTableBodyNone">Rendering plugin   </td><td class="markdownTableBodyNone">Loaded by gz-rendering    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Sensor   </td><td class="markdownTableBodyNone">Connect to callbacks   </td><td class="markdownTableBodyNone">Standalone program   </td><td class="markdownTableBodyNone">Subscribe to Gazebo Transport messages.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">All   </td><td class="markdownTableBodyNone">Connect to simulation events   </td><td class="markdownTableBodyNone">Gazebo system   </td><td class="markdownTableBodyNone">Use <code>PreUpdate</code>, <code>Update</code> and <code>PostUpdate</code> callbacks for the update loop, and the event manager for other events.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">GUI   </td><td class="markdownTableBodyNone">Add an overlay UI   </td><td class="markdownTableBodyNone">GUI plugin   </td><td class="markdownTableBodyNone">Support for overlays and docked widgets    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">GUI / System   </td><td class="markdownTableBodyNone">Change the default UI   </td><td class="markdownTableBodyNone">GUI plugin / SDF   </td><td class="markdownTableBodyNone">All GUI elements can be removed or configured through SDF    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">System   </td><td class="markdownTableBodyNone">Access command line arguments   </td><td class="markdownTableBodyNone">TBD   </td><td class="markdownTableBodyNone">-   </td></tr>
</table>
<hr  />
<p>Another key difference is that systems will be able to access all entity properties at once, despite the entity type. So while in Gazebo Classic you may need 3 different plugins to interact with physics, rendering and sensors, on Gazebo you could, for example, set a camera's visual color, its velocity and frame rate, all from a single plugin.</p>
<h2><a class="anchor" id="autotoc_md270"></a>
Plugin interfaces</h2>
<p>Let's take a look at a typical Gazebo Classic plugin which accesses a property from an entity and does something with it. In this case, it will print the current pose of a link.</p>
<p>In general, the plugin will need to:</p>
<ol type="1">
<li>Get the link and store it.</li>
<li>Register a callback that is called at every simulation update.</li>
<li>At the callback, query the link's pose and print it.</li>
</ol>
<p>On classic Gazebo, that would look something like this:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;gazebo/common/Plugin.hh&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Inherit from ModelPlugin</span></div>
<div class="line"><span class="keyword">class </span>MyPlugin : <span class="keyword">public</span> ModelPlugin</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Implement Load callback, provided by ModelPlugin</span></div>
<div class="line">  <span class="comment">// and called once at startup.</span></div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> MyPlugin::Load(physics::ModelPtr _model, sdf::ElementPtr _sdf)</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// Read property from SDF</span></div>
<div class="line">    <span class="keyword">auto</span> linkName = _sdf-&gt;Get&lt;<a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>&gt;(<span class="stringliteral">&quot;link_name&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Store link pointer</span></div>
<div class="line">    this-&gt;link = _model-&gt;GetLink(linkName);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Register callback to be called at every iteration</span></div>
<div class="line">    this-&gt;updateConnection = event::Events::ConnectWorldUpdateBegin(</div>
<div class="line">            <a class="code hl_functionRef" href="http://en.cppreference.com/w/cpp/utility/functional/bind.html">std::bind</a>(&amp;MyPlugin::OnUpdate, <span class="keyword">this</span>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Custom callback called at every iteration</span></div>
<div class="line">  <span class="keywordtype">void</span> MyPlugin::OnUpdate()</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// Get link pose and print it</span></div>
<div class="line">    <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; this-&gt;link-&gt;WorldPose() &lt;&lt; <a class="code hl_functionRef" href="http://en.cppreference.com/w/cpp/io/manip/endl.html">std::endl</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Must keep the connection</span></div>
<div class="line">  <span class="keyword">private</span>: event::ConnectionPtr updateConnection;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Keep pointer to link</span></div>
<div class="line">  <span class="keyword">private</span>: physics::LinkPtr link;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Register plugin</span></div>
<div class="line">GZ_REGISTER_MODEL_PLUGIN(MyPlugin)</div>
</div><!-- fragment --><p>On Gazebo, that would be implemented as follows:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Model_8hh.html">gz/sim/Model.hh</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Util_8hh.html">gz/sim/Util.hh</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="System_8hh.html">gz/sim/System.hh</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="codeRef" href="https://gazebosim.org/api/plugin/3/Register_8hh.html">gz/plugin/Register.hh</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacegz.html" title="This library is part of the Gazebo project.">gz</a>;</div>
<div class="line"><span class="keyword">using namespace </span>sim;</div>
<div class="line"><span class="keyword">using namespace </span>systems;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Inherit from System and 2 extra interfaces:</span></div>
<div class="line"><span class="comment">// ISystemConfigure and ISystemPostUpdate</span></div>
<div class="line"><span class="keyword">class </span>MyPlugin</div>
<div class="line">      : <span class="keyword">public</span> System,</div>
<div class="line">        <span class="keyword">public</span> ISystemConfigure,</div>
<div class="line">        <span class="keyword">public</span> ISystemPostUpdate</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Implement Configure callback, provided by ISystemConfigure</span></div>
<div class="line">  <span class="comment">// and called once at startup.</span></div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> Configure(<span class="keyword">const</span> Entity &amp;_entity,</div>
<div class="line">                         <span class="keyword">const</span> <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/memory/shared_ptr.html">std::shared_ptr&lt;const sdf::Element&gt;</a> &amp;_sdf,</div>
<div class="line">                         EntityComponentManager &amp;_ecm,</div>
<div class="line">                         EventManager &amp;<span class="comment">/*_eventMgr*/</span>)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="comment">// Read property from SDF</span></div>
<div class="line">    <span class="keyword">auto</span> linkName = _sdf-&gt;Get&lt;<a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>&gt;(<span class="stringliteral">&quot;link_name&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create model object to access convenient functions</span></div>
<div class="line">    <span class="keyword">auto</span> model = Model(_entity);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get link entity</span></div>
<div class="line">    this-&gt;linkEntity = model.LinkByName(_ecm, linkName);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Implement PostUpdate callback, provided by ISystemPostUpdate</span></div>
<div class="line">  <span class="comment">// and called at every iteration, after physics is done</span></div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> PostUpdate(<span class="keyword">const</span> UpdateInfo &amp;<span class="comment">/*_info*/</span>,</div>
<div class="line">                          <span class="keyword">const</span> EntityComponentManager &amp;_ecm)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="comment">// Get link pose and print it</span></div>
<div class="line">    <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; worldPose(this-&gt;linkEntity, _ecm) &lt;&lt; <a class="code hl_functionRef" href="http://en.cppreference.com/w/cpp/io/manip/endl.html">std::endl</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// ID of link entity</span></div>
<div class="line">  <span class="keyword">private</span>: Entity linkEntity;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Register plugin</span></div>
<div class="line"><a class="code hl_defineRef" href="https://gazebosim.org/api/plugin/3/Register_8hh.html#a80cacf59ebf9a4726bb47860ff177542">GZ_ADD_PLUGIN</a>(MyPlugin,</div>
<div class="line">                    <a class="code hl_class" href="classgz_1_1sim_1_1System.html" title="Base class for a System.">gz::sim::System</a>,</div>
<div class="line">                    MyPlugin::ISystemConfigure,</div>
<div class="line">                    MyPlugin::ISystemPostUpdate)</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Add plugin alias so that we can refer to the plugin without the version</span></div>
<div class="line"><span class="comment">// namespace</span></div>
<div class="line"><a class="code hl_defineRef" href="https://gazebosim.org/api/plugin/3/Register_8hh.html#a899a1e669cb535c9fe01012cff323b49">GZ_ADD_PLUGIN_ALIAS</a>(MyPlugin, <span class="stringliteral">&quot;gz::sim::systems::MyPlugin&quot;</span>)</div>
</div><!-- fragment --><p>The example above uses headers like <code>Model.hh</code> and <code>Util.hh</code>, which offer convenient APIs for some tasks that are common during simulation. However, the real power of the ECS architecture is the direct access to all entities and components. Let's take a look at how to do the same just using the ECM's API:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="EntityComponentManager_8hh.html">gz/sim/EntityComponentManager.hh</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="System_8hh.html">gz/sim/System.hh</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="components_2Link_8hh.html">gz/sim/components/Link.hh</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Name_8hh.html">gz/sim/components/Name.hh</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ParentEntity_8hh.html">gz/sim/components/ParentEntity.hh</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Pose_8hh.html">gz/sim/components/Pose.hh</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="codeRef" href="https://gazebosim.org/api/plugin/3/Register_8hh.html">gz/plugin/Register.hh</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacegz.html" title="This library is part of the Gazebo project.">gz</a>;</div>
<div class="line"><span class="keyword">using namespace </span>sim;</div>
<div class="line"><span class="keyword">using namespace </span>systems;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Inherit from System and 2 extra interfaces:</span></div>
<div class="line"><span class="comment">// ISystemConfigure and ISystemPostUpdate</span></div>
<div class="line"><span class="keyword">class </span>MyPlugin</div>
<div class="line">      : <span class="keyword">public</span> System,</div>
<div class="line">        <span class="keyword">public</span> ISystemConfigure,</div>
<div class="line">        <span class="keyword">public</span> ISystemPostUpdate</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> Configure(<span class="keyword">const</span> Entity &amp;_entity,</div>
<div class="line">                         <span class="keyword">const</span> <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/memory/shared_ptr.html">std::shared_ptr&lt;const sdf::Element&gt;</a> &amp;_sdf,</div>
<div class="line">                         EntityComponentManager &amp;_ecm,</div>
<div class="line">                         EventManager &amp;<span class="comment">/*_eventMgr*/</span>)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="comment">// Read property from SDF</span></div>
<div class="line">    <span class="keyword">auto</span> linkName = _sdf-&gt;Get&lt;<a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a>&gt;(<span class="stringliteral">&quot;link_name&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get link entity by querying for an entity that has a specific set of</span></div>
<div class="line">    <span class="comment">// components</span></div>
<div class="line">    this-&gt;linkEntity = _ecm.EntityByComponents(</div>
<div class="line">        components::ParentEntity(_entity),</div>
<div class="line">        components::Name(linkName), components::Link());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">void</span> PostUpdate(<span class="keyword">const</span> UpdateInfo &amp;<span class="comment">/*_info*/</span>,</div>
<div class="line">                          <span class="keyword">const</span> EntityComponentManager &amp;_ecm)<span class="keyword"> override</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="comment">// Get link&#39;s local pose</span></div>
<div class="line">    <span class="keyword">auto</span> pose = _ecm.Component&lt;components::Pose&gt;(this-&gt;linkEntity)-&gt;Data();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get link&#39;s parent entity</span></div>
<div class="line">    <span class="keyword">auto</span> parent = _ecm.Component&lt;components::ParentEntity&gt;(this-&gt;linkEntity);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Iterate over parents until world is reached</span></div>
<div class="line">    <span class="keywordflow">while</span> (parent)</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// Get parent entity&#39;s pose</span></div>
<div class="line">      <span class="keyword">auto</span> parentPose = _ecm.Component&lt;components::Pose&gt;(parent-&gt;Data());</div>
<div class="line">      <span class="keywordflow">if</span> (!parentPose)</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Add pose</span></div>
<div class="line">      pose = parentPose-&gt;Data() * pose;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// keep going up the tree</span></div>
<div class="line">      parent = _ecm.Component&lt;components::ParentEntity&gt;(parent-&gt;Data());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_classRef" href="http://en.cppreference.com/w/cpp/io/basic_ostream.html">std::cout</a> &lt;&lt; pose &lt;&lt; <a class="code hl_functionRef" href="http://en.cppreference.com/w/cpp/io/manip/endl.html">std::endl</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// ID of link entity</span></div>
<div class="line">  <span class="keyword">private</span>: <a class="code hl_typedef" href="namespacegz_1_1sim.html#ad83694d867b0e3a9446b535b5dfd208d" title="An Entity identifies a single object in simulation such as a model, link, or light....">Entity</a> linkEntity;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_defineRef" href="https://gazebosim.org/api/plugin/3/Register_8hh.html#a80cacf59ebf9a4726bb47860ff177542">GZ_ADD_PLUGIN</a>(MyPlugin,</div>
<div class="line">                    <a class="code hl_class" href="classgz_1_1sim_1_1System.html" title="Base class for a System.">gz::sim::System</a>,</div>
<div class="line">                    MyPlugin::ISystemConfigure,</div>
<div class="line">                    MyPlugin::ISystemPostUpdate)</div>
<div class="line"> </div>
<div class="line"><a class="code hl_defineRef" href="https://gazebosim.org/api/plugin/3/Register_8hh.html#a899a1e669cb535c9fe01012cff323b49">GZ_ADD_PLUGIN_ALIAS</a>(MyPlugin, <span class="stringliteral">&quot;gz::sim::systems::MyPlugin&quot;</span>)</div>
</div><!-- fragment --><p>In summary, the key differences between Gazebo Classic and Gazebo are:</p>
<ul>
<li>Plugins must inherit from the <code>ISystemConfigure</code> class to be able to override the <code>Configure</code> callback that gives access to many things, such as the SDF pointer. This used to be done through the <code>Load</code> callback.</li>
<li>Plugins no longer need to manage connections to loop-related events. Instead, they implement an interface such as <code>ISystemPostUpdate</code>.</li>
<li>Plugins don't have direct access to physics objects such as <code>physics::Model</code>. Instead, they can either deal directly with entities and their components by calling functions in the ECM, or using convenient objects such as <code><a class="el" href="classgz_1_1sim_1_1Model.html" title="This class provides wrappers around entities and components which are more convenient and straight-fo...">gz::sim::Model</a></code> which wrap the ECM interface.</li>
</ul>
<p>All these changes are meant to give plugin developers more flexibility to only use the features they need, and several layers of abstraction which can be chosen according to the developer's experience and specific use-case. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
      </div>
    </main>
  </div>
</body>
