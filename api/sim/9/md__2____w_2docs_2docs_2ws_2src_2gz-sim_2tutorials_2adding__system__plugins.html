<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="keywords" content="Gazebo Sim">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gazebo Sim: md__2____w_2docs_2docs_2ws_2src_2gz-sim_2tutorials_2adding__system__plugins</title>
    <script type="text/javascript" src="https://gazebosim.org/assets/doxygen/dynsections.js"></script>
    <script type="text/javascript" src="jquery.js"></script>
    <link rel="icon" type="image/x-icon" href="https://gazebosim.org/assets/icon/favicon.ico">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.deep_orange-blue.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script>
    <link href="https://gazebosim.org/assets/doxygen/doxygen.css" rel="stylesheet" type="text/css">
  </head>
    <script type="text/javascript">
      /* Replace all the "permalink" &#9670;&nbsp; icons with a unicode link
        symbol.*/
      $(document).ready(function() {
        var elems = document.getElementsByClassName("permalink");
        for (var i = 0; i < elems.length; ++i) {
          elems[i].firstChild.innerHTML="&#x1f517;";
          elems[i].firstChild.style.fontSize="18px";
        }
      });
    </script>
  </head>
<body>
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer">
    <div class="mdl-layout__drawer mdl-color--grey-100 mdl-color-text--blue-grey-50">
      <header class="mdl-color--grey-100">
        <a href="index.html"><img width="60px" src="https://gazebosim.org/assets/doxygen/gazebo_logo.svg"/></a>
        <h1 class="project_title">Gazebo Sim</h1>
        <h2>API Reference</h2>
        <div class="version">
        9.0.0
        </div>
      </header>
      <!-- NOTE: If you add a link to a doxygen generated page, then make
                 sure to update the required_html_fils list in
                 GzCreateDocs.cmake -->
      <nav class="gz-navigation mdl-navigation">
        <a class="mdl-navigation__link" href="tutorials.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Tutorials</a>
        <a id="class_menu" class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">library_books</i>Classes</a>
        <a id="namespaces_menu"class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">toc</i>Namespaces</a>
        <a class="mdl-navigation__link" href="files.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Files</a>
        <a class="mdl-navigation__link" target="_blank"
           href="http://gazebosim.org">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">launch</i>Gazebo Website</a>
      </nav>
      <!-- classes sub menu -->
      <ul for="class_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link" href="classes.html">Index</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="annotated.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="hierarchy.html">Hierarchy</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions.html">Members: All</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_func.html">Members: Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_vars.html">Members: Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_type.html">Members: Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_enum.html">Members: Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_eval.html">Members: Enumerator</a>
        </li>
      </ul>
      <!-- namespaces sub menu -->
      <ul for="namespaces_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespaces.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers.html">Members</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_func.html">Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_type.html">Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_vars.html">Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_enum.html">Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_eval.html">Enumerator</a>
        </li>
      </ul>
    </div>
    <main class="mdl-layout__content mdl-color--white">
    <div id="top">
<!-- Generated by Doxygen 1.9.8 -->
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">md__2____w_2docs_2docs_2ws_2src_2gz-sim_2tutorials_2adding__system__plugins</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md2"></a>
Overview</h1>
<p><a class="anchor" id="adding_system_plugins"></a> This tutorial explains how to add plugins to your model to provide extra capabilities to it.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Prerequisites</h2>
<p>Make sure to go through the following tutorial first, where you'll learn how to create the vehicle used in this tutorial.</p>
<p><a href="https://gazebosim.org/api/sim/8/create_vehicle.html">https://gazebosim.org/api/sim/8/create_vehicle.html</a></p>
<h2><a class="anchor" id="autotoc_md4"></a>
Related tutorials</h2>
<p><a href="https://gazebosim.org/api/sim/8/createsystemplugins.html">https://gazebosim.org/api/sim/8/createsystemplugins.html</a></p>
<h1><a class="anchor" id="autotoc_md5"></a>
Adding a system plugin</h1>
<p><a href="https://gazebosim.org/api/sim/8/createsystemplugins.html">This Gazebo tutorial</a> describes what is a system plugin in depth. Intuitively, you can envision a system plugin as a piece of code that modifies the behavior of the simulation when the general physics engine does not exactly capture your needs. In our example, our turtle does not move because it's configured as a static model. Let's see what happens if you remove that tag.</p>
<p>Modify your <code>~/gazebo_maritime/models/my_turtle/model.sdf</code> and remove the line <code>&lt;static&gt;true&lt;/static&gt;</code>. Then launch the simulation:</p>
<div class="fragment"><div class="line">gz sim ~/gazebo_maritime/models/my_turtle/model.sdf</div>
</div><!-- fragment --><p>Hit the play button and you'll see how your turtle falls into the void. Perhaps not what you expected but this is completely normal. Gazebo thinks that your turtle is in the air without any support underneath. Then, gravity makes your turtle to free fall forever.</p>
<p>If we want to simulate that our turtle floats like if it was in the water, we'll need to attach a custom buoyancy plugin to our world. This buoyancy plugin already exists in Gazebo, we only need to load it.</p>
<p>Now, run Gazebo with the provided <code>buoyant_turtle.sdf</code> world and you'll see how your turtle does not sink anymore.</p>
<div class="fragment"><div class="line">mkdir -p ~/gazebo_maritime/worlds</div>
<div class="line">wget https://raw.githubusercontent.com/gazebosim/gz-sim/gz-sim8/tutorials/files/adding_system_plugins/buoyant_turtle.sdf -O ~/gazebo_maritime/worlds/buoyant_turtle.sdf</div>
<div class="line">export GZ_SIM_RESOURCE_PATH=:$HOME/gazebo_maritime/models</div>
<div class="line">gz sim -r ~/gazebo_maritime/worlds/buoyant_turtle.sdf</div>
</div><!-- fragment --><p>The turtle now stays floating with an oscillating movement up and down.</p>
<p>You just added buoyancy to your model! As a general rule, a maritime model will need at least two system plugins:</p>
<ol type="1">
<li>Buoyancy</li>
<li>Hydrodynamics</li>
</ol>
<p>As you have experienced, the buoyancy plugin generates an upthrust opposing some weight of the model. Your model could have positive, neutral or negative buoyancy. You'll be able to tune that aspect of your model later.</p>
<p>The hydrodynamics plugin models the force and torque that the vehicle experiences when moving within a fluid. Intuitively, the hydrodynamics plugin generates drag opposing the movement of the vehicle. If your model does not have hydrodynamics, it will behave as if there's no resistance.</p>
<p>For the sake of illustrating the effect of hydrodynamics, let's attach a simple controller to our turtle and move it without hydrodynamics. Keep in mind that the goal is to move the model one meter and stop it.</p>
<p>Uncomment the following block from <code>buoyant_turtle.sdf</code>:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">plugin</span> <span class="keyword">filename</span>=<span class="stringliteral">&quot;gz-sim-trajectory-follower-system&quot;</span></div>
<div class="line">        <span class="keyword">name</span>=<span class="stringliteral">&quot;gz::sim::systems::TrajectoryFollower&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">link_name</span>&gt;<span class="keyword">base_link</span>&lt;/<span class="keywordtype">link_name</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">force</span>&gt;0.2&lt;/<span class="keywordtype">force</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">torque</span>&gt;0.01&lt;/<span class="keywordtype">torque</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">range_tolerance</span>&gt;0.1&lt;/<span class="keywordtype">range_tolerance</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">waypoints</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">waypoint</span>&gt;1 0&lt;/<span class="keywordtype">waypoint</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">waypoints</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">plugin</span>&gt;</div>
</div><!-- fragment --><p>And run Gazebo:</p>
<div class="fragment"><div class="line">gz sim -r ~/gazebo_maritime/worlds/buoyant_turtle.sdf</div>
</div><!-- fragment --><p>As you just observed, we failed in our goal and the turtle behaved as if it was moving on ice. Now, let's add hydrodynamics.</p>
<p>Uncomment the following block from <code>buoyant_turtle.sdf</code>:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">plugin</span></div>
<div class="line">  <span class="keyword">filename</span>=<span class="stringliteral">&quot;gz-sim-hydrodynamics-system&quot;</span></div>
<div class="line">  <span class="keyword">name</span>=<span class="stringliteral">&quot;gz::sim::systems::Hydrodynamics&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">link_name</span>&gt;<span class="keyword">base_link</span>&lt;/<span class="keywordtype">link_name</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">xDotU</span>&gt;-0.04876161&lt;/<span class="keywordtype">xDotU</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">yDotV</span>&gt;-1.26324739&lt;/<span class="keywordtype">yDotV</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">zDotW</span>&gt;-1.26324739&lt;/<span class="keywordtype">zDotW</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">kDotP</span>&gt;0&lt;/<span class="keywordtype">kDotP</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">mDotQ</span>&gt;-0.3346&lt;/<span class="keywordtype">mDotQ</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">nDotR</span>&gt;-0.3346&lt;/<span class="keywordtype">nDotR</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">xUabsU</span>&gt;-0.62282&lt;/<span class="keywordtype">xUabsU</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">xU</span>&gt;-5&lt;/<span class="keywordtype">xU</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">yVabsV</span>&gt;-60.127&lt;/<span class="keywordtype">yVabsV</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">yV</span>&gt;-5&lt;/<span class="keywordtype">yV</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">zWabsW</span>&gt;-6.0127&lt;/<span class="keywordtype">zWabsW</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">zW</span>&gt;-100&lt;/<span class="keywordtype">zW</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">kPabsP</span>&gt;-0.001916&lt;/<span class="keywordtype">kPabsP</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">kP</span>&gt;-1&lt;/<span class="keywordtype">kP</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">mQabsQ</span>&gt;-6.32698957&lt;/<span class="keywordtype">mQabsQ</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">mQ</span>&gt;-1&lt;/<span class="keywordtype">mQ</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">nRabsR</span>&gt;-6.32698957&lt;/<span class="keywordtype">nRabsR</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">nR</span>&gt;-1&lt;/<span class="keywordtype">nR</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">plugin</span>&gt;</div>
</div><!-- fragment --><p>And run Gazebo:</p>
<div class="fragment"><div class="line">gz sim -r ~/gazebo_maritime/worlds/buoyant_turtle.sdf</div>
</div><!-- fragment --><p>Now, when our simple trajectory controller reaches its target and stops appling force, the turtle stops moving acting like the fluid decelerates its motion. Additionally you can notice how the up and down oscillations are also damped by the effect of the hydrodynamics.</p>
<p>The hydrodynamics are also configurable with its SDF parameters but we'll talk about configuration in a separate tutorial. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
      </div>
    </main>
  </div>
</body>
