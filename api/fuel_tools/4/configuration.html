<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="keywords" content="Gazebo Fuel_tools">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Gazebo Fuel_tools: Configuration</title>
    <script type="text/javascript" src="https://gazebosim.org/assets/doxygen/dynsections.js"></script>
    <script type="text/javascript" src="jquery.js"></script>
    <link rel="icon" type="image/x-icon" href="https://gazebosim.org/assets/icon/favicon.ico">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.deep_orange-blue.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script>
    <link href="https://gazebosim.org/assets/doxygen/doxygen.css" rel="stylesheet" type="text/css">
  </head>
    <script type="text/javascript">
      /* Replace all the "permalink" &#9670;&nbsp; icons with a unicode link
        symbol.*/
      $(document).ready(function() {
        var elems = document.getElementsByClassName("permalink");
        for (var i = 0; i < elems.length; ++i) {
          elems[i].firstChild.innerHTML="&#x1f517;";
          elems[i].firstChild.style.fontSize="18px";
        }
      });
    </script>
  </head>
<body>
  <div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer">
    <div class="mdl-layout__drawer mdl-color--grey-100 mdl-color-text--blue-grey-50">
      <header class="mdl-color--grey-100">
        <a href="index.html"><img width="60px" src="https://gazebosim.org/assets/doxygen/gazebo_logo.svg"/></a>
        <h1 class="project_title">Gazebo Fuel_tools</h1>
        <h2>API Reference</h2>
        <div class="version">
        4.9.1
        </div>
      </header>
      <!-- NOTE: If you add a link to a doxygen generated page, then make
                 sure to update the required_html_fils list in
                 IgnCreateDocs.cmake -->
      <nav class="ign-navigation mdl-navigation">
        <a class="mdl-navigation__link" href="tutorials.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Tutorials</a>
        <a id="class_menu" class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">library_books</i>Classes</a>
        <a id="namespaces_menu"class="mdl-navigation__link" href="#">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">toc</i>Namespaces</a>
        <a class="mdl-navigation__link" href="files.html">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">insert_drive_file</i>Files</a>
        <a class="mdl-navigation__link" target="_blank"
           href="http://gazebosim.org">
          <i class="mdl-color-text--grey-400 material-icons"
             role="presentation">launch</i>Gazebo Website</a>
      </nav>
      <!-- classes sub menu -->
      <ul for="class_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link" href="classes.html">Index</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="annotated.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="hierarchy.html">Hierarchy</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions.html">Members: All</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_func.html">Members: Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_vars.html">Members: Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_type.html">Members: Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_enum.html">Members: Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
             href="functions_eval.html">Members: Enumerator</a>
        </li>
      </ul>
      <!-- namespaces sub menu -->
      <ul for="namespaces_menu" class="mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect mdl-navigation">
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespaces.html">List</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers.html">Members</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_func.html">Functions</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_type.html">Typedefs</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_vars.html">Variables</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_enum.html">Enumerations</a>
        </li>
        <li class="mdl-menu__item">
          <a class="mdl-navigation__link"
            href="namespacemembers_eval.html">Enumerator</a>
        </li>
      </ul>
    </div>
    <main class="mdl-layout__content mdl-color--white">
    <div id="top">
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Configuration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Next Tutorial: <a class="el" href="cmdline.html">Command Line Tools</a></p>
<h2><a class="anchor" id="autotoc_md13"></a>
Overview</h2>
<p>Some aspects of Gazebo Fuel Tools can be configured according to the needs of the library users. This configuration can be done via a YAML configuration file or programatically.</p>
<p>Gazebo Fuel Tools accepts a YAML file with the following syntax:</p>
<div class="fragment"><div class="line">---</div>
<div class="line"># The list of servers.</div>
<div class="line">servers:</div>
<div class="line">  -</div>
<div class="line">    url: https://fuel.gazbosim.org</div>
<div class="line">    private-token: &lt;your private token&gt;</div>
<div class="line"> </div>
<div class="line">  # -</div>
<div class="line">    # url: https://myserver</div>
<div class="line"> </div>
<div class="line"># Where are the assets stored in disk.</div>
<div class="line"># cache:</div>
<div class="line">#   path: /tmp/gz/fuel</div>
</div><!-- fragment --><p>The <code>servers</code> section specifies all Fuel servers to interact with. For each server, you must specify the URL to send the HTTP requests. If the server requires auth you can specify the token filling the optional field <code>private-token</code>.</p>
<p>The <code>cache</code> section captures options related with the local storage of the assets. <code>path</code> specifies the local directory where all assets will be downloaded. If not used, all assets are stored under <code>$HOME/.gz/fuel</code>.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
Custom configuration file path</h2>
<p>Gazebo Fuel's default configuration file is stored under <code>$HOME/.gz/fuel/config.yaml</code>, but it is possible to load a configuration file from a custom path programmatically. Let's see how.</p>
<p>Create a file <code>/tmp/my_config.yaml</code> with the following content:</p>
<div class="fragment"><div class="line">---</div>
<div class="line"># The list of servers.</div>
<div class="line">servers:</div>
<div class="line">  -</div>
<div class="line">    url: https://fuel.gazebosim.org</div>
<div class="line"> </div>
<div class="line"># Where are the assets stored in disk.</div>
<div class="line">cache:</div>
<div class="line">  path: /tmp/gz/fuel</div>
</div><!-- fragment --><p>Now, let's use a program that downloads a resource from a server in the custom configuration file. Let's start by creating a directory for storing all files:</p>
<div class="fragment"><div class="line">mkdir /tmp/conf_tutorial &amp;&amp; cd /tmp/conf_tutorial</div>
</div><!-- fragment --><p>Download the file <code>download.cc</code> and save it under <code>/tmp/conf_tutorial</code>:</p>
<div class="fragment"><div class="line">wget https://github.com/gazebosim/gz-fuel-tools/raw/gz-fuel-tools4/example/download.cc</div>
</div><!-- fragment --><p>Also, download <code>CMakeLists.txt</code> for compiling the example:</p>
<div class="fragment"><div class="line">wget https://github.com/gazebosim/gz-fuel-tools/raw/gz-fuel-tools4/example/CMakeLists.txt</div>
</div><!-- fragment --><p>Install a dependency: </p><div class="fragment"><div class="line">sudo apt-get install libgflags-dev</div>
</div><!-- fragment --><p>Let's compile the example:</p>
<div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line">cmake ..</div>
<div class="line">make</div>
</div><!-- fragment --><p>And now the fun part, execute it:</p>
<div class="fragment"><div class="line">./download -c /tmp/my_config.yaml -o caguero -n Beer -t model</div>
</div><!-- fragment --><p>Verify that you have the model in <code>/tmp/gz/fuel/fuel.gazebosim.org/caguero/models/Beer</code>, as you configured in your YAML file.</p>
<h2><a class="anchor" id="autotoc_md15"></a>
Walkthrough</h2>
<p>Let's jump to the interesting parts of the program:</p>
<div class="fragment"><div class="line">// Setup ClientConfig.</div>
<div class="line">gz::fuel_tools::ClientConfig conf;</div>
<div class="line"> </div>
<div class="line">if (FLAGS_s != &quot;&quot;)</div>
<div class="line">{</div>
<div class="line">  // The user specified a Fuel server via command line.</div>
<div class="line">  gz::fuel_tools::ServerConfig srv;</div>
<div class="line">  srv.SetUrl(gz::common::URI(FLAGS_s));</div>
<div class="line"> </div>
<div class="line">  // Add the extra Fuel server.</div>
<div class="line">  conf.AddServer(srv);</div>
<div class="line">}</div>
</div><!-- fragment --><p>In the previous block, we can see how a <code>ClientConfig</code> is instantiated. This class lets you specify different options to be customized by the client using the library.</p>
<p>Next, we check if <code>-s</code> (server) has been used when invoking our program. If that's the case, we instantiate an object of <code>ServerConfig</code> and we fill the URL with the value of the <code>-s</code> flag.</p>
<p>Next, we use <code>AddServer()</code> to register the new server. The previous block shows an example of a programmatic way of configuring a Fuel server. Let's focus on the next interesting piece of code:</p>
<div class="fragment"><div class="line">if (FLAGS_c != &quot;&quot;)</div>
<div class="line">    conf.SetConfigPath(FLAGS_c);</div>
<div class="line"> </div>
<div class="line">if (!conf.LoadConfig())</div>
<div class="line">{</div>
<div class="line">  std::cerr &lt;&lt; &quot;Error loading configuration file [&quot; &lt;&lt; FLAGS_c &lt;&lt; &quot;]&quot;</div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">  return -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// Instantiate the FuelClient object with the configuration.</div>
<div class="line">gz::fuel_tools::FuelClient client(conf);</div>
</div><!-- fragment --><p>Here, we check if the user specified a <code>-c</code> (config) option. If so, we need to tell <code>conf</code> about the path where the configuration file is located. For this purpose we use <code>SetConfigPath()</code>. As we're interested in using a configuration file, we need to call <code>LoadConfig()</code>. It's important to note that if we call <code>LoadConfig()</code> without calling <code>SetConfigPath()</code> beforehand, a default configuration file will be loaded (and created if it doesn't already exist under <code>$HOME/.gz/fuel/config.yaml</code>). If the user doesn't call <code>LoadConfig()</code>, no configuration file will be used at all.</p>
<p>Once we have all our configuration ready and captured in the <code>conf</code> object, we can instantiate the <code>FuelClient</code> object (client). This is the class that performs the main operations, such as the model download described in this example.</p>
<div class="fragment"><div class="line">// Set the properties of the resource that we want to download.</div>
<div class="line">gz::fuel_tools::ModelIdentifier modelIdentifier;</div>
<div class="line">gz::fuel_tools::WorldIdentifier worldIdentifier;</div>
<div class="line"> </div>
<div class="line">if (FLAGS_t == &quot;model&quot;)</div>
<div class="line">{</div>
<div class="line">  modelIdentifier.SetOwner(FLAGS_o);</div>
<div class="line">  modelIdentifier.SetName(FLAGS_n);</div>
<div class="line">}</div>
<div class="line">else if (FLAGS_t == &quot;world&quot;)</div>
<div class="line">{</div>
<div class="line">  worldIdentifier.SetOwner(FLAGS_o);</div>
<div class="line">  worldIdentifier.SetName(FLAGS_n);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// Fetch the resource.</div>
<div class="line">for (const auto &amp;server : client.Config().Servers())</div>
<div class="line">{</div>
<div class="line">  if (FLAGS_t == &quot;model&quot;)</div>
<div class="line">  {</div>
<div class="line">    // Set server</div>
<div class="line">    auto id = modelIdentifier;</div>
<div class="line">    id.SetServer(server);</div>
<div class="line"> </div>
<div class="line">    // Download</div>
<div class="line">    if (client.DownloadModel(server, id))</div>
<div class="line">      return 0;</div>
<div class="line">  }</div>
<div class="line">  else if (FLAGS_t == &quot;world&quot;)</div>
<div class="line">  {</div>
<div class="line">    // Set server</div>
<div class="line">    auto id = worldIdentifier;</div>
<div class="line">    id.SetServer(server);</div>
<div class="line"> </div>
<div class="line">    // Download</div>
<div class="line">    if (client.DownloadWorld(id))</div>
<div class="line">      return 0;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>The code above sets the owner and name of the requested resource. Finally, it iterates over all available Fuel servers and tries to download it. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
      </div>
    </main>
  </div>
</body>
